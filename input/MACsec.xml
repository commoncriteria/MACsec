<?xml version="1.0" encoding="utf-8"?>
<?xsl-stylesheet type="text/xsl" href="../transforms/xls/module/module2html.xsl"?>

<?xml-model href="../transforms/schemas/CCModule.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>



<Module
    xmlns="https://niap-ccevs.org/cc/v1"
  xmlns:sec="https://niap-ccevs.org/cc/v1/section"
  xmlns:h="http://www.w3.org/1999/xhtml">
  <product_class>MACsec Ethernet Encryption</product_class>
  <plural>MACsec Ethernet Encryption</plural> 
 
  <RevisionHistory>
    <entry>
      <version>1.0</version>
      <date>2022-12-16</date>
      <subject>Initial Release</subject>
    </entry>
  </RevisionHistory>
  
  <!-- TODO: see Issues for open items -->
  
  <sec:Introduction>
    <sec:Overview>
      The scope of this Protection Profile Module (PP-Module) is to describe the security functionality of Media Access Control Security (MACsec) encryption in terms of the Common Criteria [CC] 
      and to define functional and assurance requirements for such products. This PP-Module is intended for use with the following Base Protection Profiles (Base-PPs):
      <h:ul>
        <h:li>collaborative Protection Profile for
          Network Devices, Version 2.2e (NDcPP)</h:li>
      </h:ul>
      <h:p>
      This Base-PP is valid because a device that implements MACsec encryption is a specific type of network device, 
      and there is nothing about the implementation of MACsec that would prevent any of the security capabilities defined by the Base-PP from being satisfied.
      </h:p><h:p>
      A Target of Evaluation (TOE) that conforms to a PP-Configuration containing this PP-Module may be a ‘Distributed TOE’ as defined in the NDcPP. 
      This PP-Module does not prohibit the TOE from implementing other security functionality in a distributed manner. 
      For example, a TOE may be deployed in such a manner that distributed nodes establish MACsec connectivity with physically separated networks 
      while a centralized management device is used to configure the behavior of individual nodes.
      </h:p>
      
    </sec:Overview>
    <tech-terms>
      <suppress>Functional Package,Extended Package</suppress>
      <term full="Carrier Ethernet">
        Metro Ethernet Forum (MEF) Carrier Ethernet standards define technology-agnostic layer-2 services. 
        The standards include services aimed at end users (Subscriber Ethernet Services) 
        and service providers (Operator Ethernet Services). 
        Other related terms include Metro Ethernet Services, Provider Bridging and Provider Backbone Bridging.
      </term>
      <term abbr="CA" full="Connectivity Association"/>
      <term abbr="CAK" plural="CAKs" full="Connectivity Association Key">
        A symmetric key that is used as the master key for MACsec connectivity and is shared between connected MACsec endpoints.
      </term>
      <term abbr="CKN" full="Connectivity Association Key Name">
        A unique identifier for a specific Connectivity Association Key.
      </term>
      <term abbr="CMAC" full="Cipher-based Message Authentication Code"/>
      <term abbr="DevID" full="Device Identifier"/>
      <term abbr="EA" full="Evaluation Activity"/>
      <term abbr="EAP" full="Extensible Authentication Protocol"/>
      <term abbr="EAP-TLS" full="EAP Transport Layer Security"/>
      <term abbr="EAPOL" full="Extensible Authentication Protocol over LAN">
        A port authentication protocol specified in IEEE 802.1X that is used to facilitate network authentication.
      </term>
      <term abbr="EPL" full="Ethernet Private Line">
        A service transporting customer data form one User Network Interface (UNI) to another UNI.
      </term>
      <term abbr="EVPL" full="Ethernet Virtual Private Line">
        A Virtual Local Area Network (VLAN)-based service transporting customer data. The UNI is capable of service multiplexing. 
      </term>
      <term abbr="XPN" full="Extended Packet Numbering">
        A scheme that allows MACsec communications to persist using a single Secure Association Key 
        for a larger number of frames to reduce overhead and latency associated with key agreement.
      </term>
      <term abbr="ICK" full="Integrity Check Value Key"/>
      <term abbr="ICV" full="Integrity Check Value"/>
      <term abbr="IEEE" full="Institute of Electrical and Electronics Engineers"/>
      <term abbr="IV" full="Initialization Vector"/>
      <term abbr="KaY" full="Key Agreement Entity"/>
      <term abbr="KDF" full="Key Derivation Function"/>
      <term abbr="KW" full="Key Wrap"/>
      <term abbr="LAN" full="Local Area Network"/>
      <term abbr="MAC" full="Media Access Control"/>
      <term abbr="MACsec" full="Media Access Control Security">
        A standard for connectionless data confidentiality and integrity protection at the data link layer of a network connection. Formally defined in IEEE 802.1AE.
      </term>
      <term abbr="MIB" full="Management Information Base"/>
      <term abbr="MKA" full="MACsec Key Agreement">
        A key agreement protocol used for distribution of MACsec keys to distributed peers.
      </term>
      <term abbr="MKPDU" full="MACsec Key Agreement Protocol Data Unit"/>
      <term abbr="MPDU" full="MACsec Protocol Data Unit">
        The basic MACsec frame structure that contains protcol and payload data.
      </term>
      <term full="Media Access Control (MAC) Security Entity">
        An entity (e.g., computer) that is implementing MACsec.
      </term>
      <term abbr="MEF" full="Metro Ethernet Forum">
        A non-profit international industry consortium.
      </term>
      <term abbr="NDcPP" full="collaborative Protection Profile for Network Devices"/>
      <term abbr="P2P" full="Point-to-Point"/>
      <term abbr="PAE" full="Port Access Entity"/>
      <term abbr="POST" full="Power On Self Test"/>
      <term abbr="PN" full="Packet Number">
        A monotonically increasing value that is guaranteed to be unique for each MACsec frame transmitted using a given Secure Association Key (SAK)
      </term>
      <term abbr="PSK" full="Pre-Shared Key"/>
      <term abbr="RFC" full="Request for Comment"/>
      <term abbr="SA" full="Secure Association">
        A mechanism that uses a SAK to provide the MACsec service guarantees and security services for a sequence of transmitted frames.
      </term>
      <term abbr="SAK" full="Secure Association Key">
        A key derived from the CAK that is used to encrypt and decrypt traffic for a given SA.
      </term>
      <term abbr="SC" full="Secure Channel">
        A unidirectional channel (one to one or one to many) that uses symmetric key cryptography to provide a (possibly long lived) Secure Channel.
      </term>
      <term abbr="SCI" full="Secure Channel Identifier"/>
      <term full="SecTag">
        MAC Security Tag - a protocol header comprising a number of octets, beginning with an EtherType, that is prepended to the service data unit 
        supplied by the client of the protocol and is used to provide security guarantees.
      </term>
      <term full="Secure Device Identifier">
        A device authentication credential that can be used for EAPOL and is formally defined in IEEE 802.1AR.
      </term>
      <term abbr="SNMP" full="Simple Network Management Protocol"/>
      <term abbr="UNI" full="User Network Interface"/>
      <term abbr="VLAN" full="Virtual Local Area Network"/>
      
      
      

    </tech-terms>
    <sec:Compliant_Targets_of_Evaluation>
      <h:p>
      This PP-Module specifically addresses MACsec, which allows authorized systems using Ethernet Transport to maintain confidentiality of transmitted data 
      and to take measures against frames that are transmitted or modified by unauthorized devices.
      </h:p><h:p>
      MACsec protects communication between trusted components of the network infrastructure, thus protecting the network operation. 
      It facilitates maintenance of correct network connectivity and services as well as isolation of denial of service attacks.
      </h:p><h:p>
      The hardware, firmware, and software of the MACsec device define the physical boundary. 
      All of the security functionality is contained and executed within the physical boundary of the device. 
      For example, given a device with an Ethernet card, the whole device is considered to be within the boundary.
      </h:p><h:p>
      Since this PP-Module builds on the NDcPP, conformant TOEs are obligated to implement the functionality required in the NDcPP along with 
      the additional functionality defined in this PP-Module in response to the threat environment discussed later in this document. 
      </h:p>
    </sec:Compliant_Targets_of_Evaluation>
      <sec:TOE_Boundary>
        The physical boundary for a TOE that conforms to this PP-Module is a hardware appliance that also provides generalized network device functionality, 
        such as auditing, I&amp;A, and cryptographic services for network communications. 
        The TOE’s logical boundary includes all functionality required by the claimed Base-PP as well as the MACsec functionality 
        and related capabilities that are defined in this PP-Module. 
        Any functionality that is provided by the network device that is not relevant to the security requirements defined by this PP-Module 
        or the Base-PP is considered to be outside the scope of the TOE.
      </sec:TOE_Boundary>
    
    
    <sec:Use_Cases>
      <h:p>
      A pair of MACsec devices connected by a physical medium can protect Ethernet frames switched or routed from one device to the other. 
      The two MACsec devices are provided with a CAK and use the MKA protocol to create a secure tunnel. 
      MKA is used by the two MACsec devices to agree upon MACsec keys. 
      A policy should be installed to protect traffic between the devices, with the exception of the MKA or Ethernet control traffic such as 
      Extensible Authentication Protocol (EAP) over LAN (EAPOL) frames.
      </h:p><h:p>
      This PP-Module defines two potential use cases for the MACsec TOE.
      </h:p>
      <usecases>
        <usecase id="usecase-hopbyhop" title="Classic Hop by Hop Deployment">
          <description>
            MACsec can be deployed in a hop by hop manner between Ethernet devices.  
            Two devices will protect traffic originating in protected networks traversing an untrusted link between them. 
            The devices will first exchange MKA frames, which serve to determine the peer is an authorized peer, 
            and agree upon a shared key and MACsec ciphersuite used to set up a transmit (Tx) SA and a receive (Rx) SA. 
            Once the SAs are set up, MACsec-protected frames traverse the unprotected link. 
          </description>
        </usecase>
        <usecase id="usecase-carrier" title="Over Carrier Ethernet Services">
          <description>
            <h:p>
            In some markets network service providers have standardized their offerings according to various versions of the MEF specifications.  
            One recent MEF specification is the “E-Line” (*) service type which is based on the use of point-to-point (P2P) Ethernet Virtual Circuits. 
            A port-based service is known as an EPL and a VLAN-based service is known as an EVPL. 
            EPL provides a P2P Ethernet virtual connection between a pair of dedicated user–network interfaces (UNIs), 
            with a high degree of transparency. EVPL provides a P2P or point-to-multipoint connection between UNIs.  
            A difference between the EVPL and EPL is the degree of transparency - while EPL is highly transparent, filtering only the pause frames, 
            EVPL is required to either peer or drop most of the Layer 2 Control Protocols.  The MEF has also defined other service types such as E-LAN and E-Tree.
            </h:p><h:p>
            (*) From MEF 6.3 – Subscriber Ethernet Services Definition – November 2019 – Table 3
            </h:p>
          </description>
        </usecase>
      </usecases> 
    </sec:Use_Cases> 
  </sec:Introduction>
  <sec:Conformance_Claims boilerplate="no">
    <cclaims>
      <cclaim name="Conformance Statement">
        <description>
	  <h:p>
	    This PP-Module inherits exact conformance as required from the specified
            Base-PP and as defined in the CC and CEM addenda for Exact Conformance, Selection-Based
          SFRs, and Optional SFRs (dated May 2017).</h:p>
	  <h:p>
	    The following PP-Modules are allowed to be specified in a PP-Configuration with this PP-Module:
	    <h:ul>
	      <h:li>PP-Module for Stateful Traffic Filter Firewalls Version 1.4 + Errata 20200625 (MOD_FW)</h:li>
	      <h:li>PP-Module for Virtual Private Network (VPN) Gateways Version 1.2 (MOD_VPNGW)</h:li> 
	    </h:ul>
	  </h:p>
        </description>
      </cclaim>
      <cclaim name="CC Conformance Claims">
        <description>This PP-Module is conformant to Parts 2 (extended) and 3 (conformant) of Common
          Criteria Version 3.1, Release 5 [CC]. </description>
      </cclaim>
      <cclaim name="Package Claims">
        <description>This PP-Module does not
          claim conformance to any packages.</description>
      </cclaim>
    </cclaims>
  </sec:Conformance_Claims>
  <sec:Security_Problem_Description>
    The security problem is described in terms of the threats that the TOE is expected to address, assumptions about its Operational Environment, 
    and any organizational security policies that the TOE is expected to enforce.
    <sec:Threats>
      The following threats that are defined in this PP-Module extend the threats that are defined by the Base-PP.
      <threats>
        <threat name="T.DATA_INTEGRITY">
          <description>
            <h:p>
            An attacker may modify data transmitted over the layer 2 link in a way that is not detected by the recipient.
            </h:p><h:p>
            Devices on a network may be exposed to attacks that attempt to corrupt or modify data in transit without authorization. 
            If malicious devices are able to modify and replay data that is transmitted over a layer 2 link, then the data contained within the communications 
            may be susceptible to a loss of integrity.
            </h:p>
          </description>
          
          <objective-refer ref="O.CRYPTOGRAPHIC_FUNCTIONS_MACSEC">
            <rationale>
              The TOE mitigates the threat of data integrity violations by implementing cryptographic functionality that includes integrity protection.
            </rationale>
          </objective-refer>
          <objective-refer ref="O.REPLAY_DETECTION">
            <rationale>
              The TOE mitigates the threat of data integrity violations by providing a mechanism to detect and discard replayed traffic for MPDUs.
            </rationale>
          </objective-refer>
        </threat>
        
        <threat name="T.NETWORK_ACCESS">
          <description>
            <h:p>
            An attacker may send traffic through the TOE that enables them to access devices in the TOE’s operational environment without authorization.
            </h:p><h:p>
            A MACsec device may sit on the periphery of a network, which means that it may have an externally-facing interface to a public network. 
            Devices located in the public network may attempt to exercise services located on the internal network that are intended to be accessed 
            only from within the internal network or externally accessible only from specifically authorized devices. 
            If the MACsec device allows unauthorized external devices access to the internal network, 
            these devices on the internal network may be subject to compromise. 
            Similarly, if two MACsec devices are deployed to facilitate end-to-end encryption of traffic that is contained within a single network, 
            an attacker could use an insecure MACsec device as a method to access devices on a specific segment of that network such as an individual LAN.
            </h:p>
          </description>

          <objective-refer ref="O.PORT_FILTERING_MACSEC">
            <rationale>
              The TOE’s port filtering capability reduces the threat of unauthorized access to devices in the TOE’s operational environment by 
              restricting the flow of network traffic entering through the TOE interfaces based on layer 2 frame characteristics and 
              whether or not the traffic represents valid MACsec frames and MKPDUs.
            </rationale>
          </objective-refer>
        </threat>
        
        
        <threat name="T.UNTRUSTED_MACSEC_COMMUNICATION_CHANNELS">
          <description>
            <h:p>
            An attacker may acquire sensitive TOE or user data that is transmitted to or from the TOE because an untrusted communication channel 
            causes a disclosure of data in transit.
            </h:p><h:p>
            A generic network device may be threatened by the use of insecure communications channels to transmit sensitive data. 
            The attack surface of a MACsec device also includes the MACsec trusted channels. 
            Inability to secure communications channels, or failure to do so correctly, would expose user data that is assumed to be secure to the threat of unauthorized disclosure.
            </h:p>
          </description>
         
          <objective-refer ref="O.CRYPTOGRAPHIC_FUNCTIONS_MACSEC">
            <rationale>
              The TOE mitigates the threat of unauthorized disclosure of information via untrusted thru traffic 
              by providing MKA authentication functions to authorize endpoints.
            </rationale>
          </objective-refer>
        </threat>
        
        <threat name="T.UNAUTHORIZED_ADMINISTRATOR_ACCESS">
          <from base="NDcPP"/>
          <objective-refer ref="O.AUTHORIZED_ADMINISTRATION">
            <rationale>The TOE further mitigates this threat originally defined in the Base-PP by defining additional 
              management functions that require authorization 
              and additional interfaces that can be used securely to execute management activities.</rationale>
          </objective-refer>
        </threat>
        
        <threat name="T.UNDETECTED_ACTIVITY">
          <from base="NDcPP"/>
          <objective-refer ref="O.SYSTEM_MONITORING_MACSEC">
            <rationale>The TOE further mitigates this threat originally defined in the Base-PP by implementing 
              measures to generate audit records for security-relevant events that are specific
            to the functionality defined by this PP-Module.</rationale>
          </objective-refer>
        </threat>

        
      </threats>
    </sec:Threats>
    <sec:Assumptions>
      All assumptions for the OE of the Base-PP also apply to this PP-Module. 
      A.NO_THRU_TRAFFIC_PROTECTION is still operative, but only for the interfaces in the TOE that are defined by the Base-PP and not the PP-Module.
      <assumptions/>
    </sec:Assumptions>
    
    <sec:Organizational_Security_Policies>
      <!-- This PP-Module defines no additional organizational security policies beyond those specified in the NDcPP. -->
      <OSPs/>
    </sec:Organizational_Security_Policies>
  </sec:Security_Problem_Description>
  <sec:Security_Objectives>
    <sec:Security_Objectives_for_the_TOE>

      <SOs>
        
        <SO name="O.AUTHENTICATION_MACSEC">
          <description>
            <h:p>
              To further address the issues associated with unauthorized disclosure of information, a compliant TOE’s authentication ability (MKA) 
              will allow a MACsec peer to establish connectivity associations (CAs) with another MACsec peer. 
              MACsec endpoints authenticate each other to ensure they are communicating with an authorized MAC Security Entity (SecY) entity.
          </h:p>
            <h:b>Addressed by:</h:b> FCS_MACSEC_EXT.4, FCS_MKA_EXT.1, FIA_PSK_EXT.1, FCS_DEVID_EXT.1 (selection-based), FCS_EAP-TLS_EXT.1 (selection-based) 
          </description>
          <consistency-rationale>
            The NDcPP does not define any TOE objectives; instead, it maps SFRs directly to threats. 
            This TOE objective is consistent with the NDcPP because the individual security functions needed to satisfy the objective do not contradict with the security functions required by the NDcPP.
          </consistency-rationale>
          <addressed-by>FCS_MACSEC_EXT.4</addressed-by>
          <rationale>
            This SFR helps satisfy the TOE objective by defining the methods used for MACsec peer authentication and the handling of MACsec keys.
          </rationale>
          <addressed-by>FCS_MKA_EXT.1</addressed-by>
          <rationale>
            This SFR helps satisfy the TOE objective by defining the method used to perform MACsec key agreement.
          </rationale>
          <addressed-by>FIA_PSK_EXT.1</addressed-by>
          <rationale>
            This SFR helps satisfy the TOE objective by defining requirements for the composition and use of PSKs that can be used for MACsec peer authentication.
          </rationale>
          <addressed-by>FCS_DEVID_EXT.1 (selection-based)</addressed-by>
          <rationale>
            This SFR helps satisfy the TOE objective by optionally implementing DevIDs as a method for authenticating MACsec peers.
          </rationale>
          <addressed-by>FCS_EAPTLS_EXT.1 (selection-based)</addressed-by>
          <rationale>
            This SFR helps satisfy the TOE objective by optionally implementing EAP-TLS as a method for authenticating MACsec peers.
          </rationale>
        </SO>
        
        
        <SO name="O.AUTHORIZED_ADMINISTRATION">
          <description>
            <h:p>
            All network devices are expected to provide services that allow the security functionality of the device to be managed. 
            The MACsec device, as a specific type of network device, has a refined set of management functions to address its specialized behavior. 
            In order to further mitigate the threat of a compromise of its security functionality, 
            the MACsec device prescribes the ability to limit brute-force authentication attempts by enforcing lockout of accounts that experience 
            excessive failures and by limiting access to security-relevant data that administrators do not need to view.
            </h:p>
            <h:b>Addressed by:</h:b> FMT_SMF.1/MACSEC, FPT_CAK_EXT.1, FIA_AFL_EXT.1 (optional), FTP_TRP.1/MACSEC (optional), FMT_SNMP_EXT.1 (selection-based)
          </description>
          <consistency-rationale>
            The NDcPP does not define any TOE objectives; instead, it maps SFRs directly to threats. 
            This TOE objective is consistent with the NDcPP because the individual security functions needed to satisfy the objective do not contradict with the security functions required by the NDcPP.
          </consistency-rationale>
          <addressed-by>FMT_SMF.1/MACSEC</addressed-by>
          <rationale>
            This SFR helps satisfy the TOE objective by defining management functions that are applicable to MACsec functionality.
          </rationale>
          <addressed-by>FPT_CAK_EXT.1</addressed-by>
          <rationale>
            This SFR helps satisfy the TOE objective by protecting data that could be used to compromise the security of remote administration.
          </rationale>
          <addressed-by>FIA_AFL_EXT.1 (optional)</addressed-by>
          <rationale>
            This SFR helps satisfy the TOE objective by optionally enforcing specific limitations on how the TSF throttles local authentication attempts to prevent brute-force impersonation.
          </rationale>
          <addressed-by>FTP_TRP.1/MACSEC (optional)</addressed-by>
          <rationale>
            This SFR helps satisfy the TOE objective by defining an optional method of remote administration for the management functionality defined in this PP-Module.
          </rationale>
          <addressed-by>FMT_SNMP_EXT.1 (selection-based)</addressed-by>
          <rationale>
            This SFR helps satisfy the TOE objective by defining how Simple Network Management Protocol (SNMP) must be securely implemented if it is used for remote administration.
          </rationale>
        </SO>
        
      
        <SO name="O.CRYPTOGRAPHIC_FUNCTIONS_MACSEC">
          <description>
            <h:p>
            To address the issues associated with unauthorized modification and disclosure of information, compliant TOEs will implement cryptographic capabilities. 
            These capabilities are intended to maintain confidentiality and allow for detection and modification of data that is transmitted outside of the TOE.
            </h:p>
            <h:b>Addressed by:</h:b> FCS_COP.1/CMAC, FCS_COP.1/MACSEC, FCS_MACSEC_EXT.2, FCS_MACSEC_EXT.3, FTP_ITC.1/MACSEC, 
            FTP_TRP.1/MACSEC (optional), FCS_SNMP_EXT.1 (selection-based)
          </description>
          <consistency-rationale>
            The NDcPP does not define any TOE objectives; instead, it maps SFRs directly to threats. 
            This TOE objective is consistent with the NDcPP because the individual security functions needed to satisfy the objective do not contradict with the security functions required by the NDcPP.
          </consistency-rationale>
          <addressed-by>FCS_COP.1/CMAC</addressed-by>
          <rationale>
            This SFR helps satisfy the TOE objective by defining the AES-CMAC algorithm that is used for MACsec communications.
          </rationale>
          <addressed-by>FCS_COP.1/MACSEC</addressed-by>
          <rationale>
            This SFR helps satisfy the TOE objective by defining the AES Key Wrap algorithm that is used for MACsec communications.
          </rationale>
          <addressed-by>FCS_MACSEC_EXT.2</addressed-by>
          <rationale>
            This SFR helps satisfy the TOE objective by implementing integrity protection for MACsec.
          </rationale>
          <addressed-by>FCS_MACSEC_EXT.3</addressed-by>
          <rationale>
            This SFR helps satisfy the TOE objective by randomizing keys used for MACsec with sufficient entropy.
          </rationale>
          <addressed-by>FTP_ITC.1/MACSEC</addressed-by>
          <rationale>
            This SFR helps satisfy the TOE objective by defining the ability of the TOE to interact with external entities using MACsec, which is a cryptographically-secured communications channel.
          </rationale>
          <addressed-by>FTP_TRP.1/MACSEC (optional)</addressed-by>
          <rationale>
            This SFR helps satisfy the TOE objective by defining additional optional methods of secure remote administration for the TOE beyond those specified in the Base-PP.
          </rationale>
          <addressed-by>FCS_SNMP_EXT.1 (selection-based)</addressed-by>
          <rationale>
            This SFR helps satisfy the TOE objective by ensuring that SNMP, if implemented, is implemented securely using TLS.
          </rationale>

        </SO>
        
        
        <SO name="O.PORT_FILTERING_MACSEC">
          <description>To further address the issues associated with unauthorized network access, a compliant TOE’s port filtering capability will restrict 
            the flow of network traffic through the TOE based on layer 2 frame characteristics and whether or not the traffic represents valid MACsec frames 
            and MACsec Key Agreement Protocol Data Units (MKPDUs).
            <h:p/>
            <h:b>Addressed by:</h:b> FCS_MACSEC_EXT.1, FIA_PSK_EXT.1, FPT_DDP_EXT.1
          </description>
          <consistency-rationale>
            The NDcPP does not define any TOE objectives; instead, it maps SFRs directly to threats. 
            This TOE objective is consistent with the NDcPP because the individual security functions needed to satisfy the objective do not contradict with the security functions required by the NDcPP.
          </consistency-rationale>
          <addressed-by>FCS_MACSEC_EXT.1</addressed-by>
          <rationale>
            This SFR helps satisfy the TOE objective by implementing MACsec functionality in such a way that only authorized packet frames are permitted.
          </rationale>
          <addressed-by>FIA_PSK_EXT.1</addressed-by>
          <rationale>
            This SFR helps satisfy the TOE objective by using PSKs to determine which connections are authenticated and should therefore not be filtered.
          </rationale>
          <addressed-by>FPT_DDP_EXT.1 (optional)</addressed-by>
          <rationale>
            This SFR adds a time-based port filtering function.
          </rationale>
        </SO>
        
        
        <SO name="O.REPLAY_DETECTION">
          <description>
            A MACsec device is expected to help mitigate the threat of MACsec data integrity violations by providing a mechanism to 
            detect and discard replayed traffic for MPDUs.
            <h:p/>
            <h:b>Addressed by:</h:b> FPT_RPL.1, FPT_RPL_EXT.1 (optional)
          </description>
          <consistency-rationale>
            The NDcPP does not define any TOE objectives; instead, it maps SFRs directly to threats. 
            This TOE objective is consistent with the NDcPP because the individual security functions needed to satisfy the objective do not contradict with the security functions required by the NDcPP.
          </consistency-rationale>
          <addressed-by>FPT_RPL.1</addressed-by>
          <rationale>
            This SFR helps satisfy the TOE objective by requiring the TSF to detect and discard replayed MACsec traffic.
          </rationale>
          <addressed-by>FPT_RPL_EXT.1 (optional)</addressed-by>
          <rationale>
            This SFR helps satisfy the TOE objective by optionally defining the ability of the TSF to use XPN for replay detection.
          </rationale>
        </SO>
        
        
        <SO name="O.SYSTEM_MONITORING_MACSEC">
          <description>
            To address the issues of administrators being able to monitor the operations of the MACsec device, 
            compliant TOEs will implement the ability to log the flow of Ethernet traffic. Specifically, the TOE will provide the means for administrators to 
            configure rules to ‘log’ when Ethernet traffic grants or restricts access. As a result, the ‘log’ will result in informative event logs whenever a match occurs. 
            In addition, the establishment of security CAs is auditable, not only between MACsec devices, but also with MAC Security Key Agreement Entities (KaYs).
            <h:p/>
            <h:b>Addressed by:</h:b> FAU_GEN.1/MACSEC
          </description>
          <consistency-rationale>
            The NDcPP does not define any TOE objectives; instead, it maps SFRs directly to threats. 
            This TOE objective is consistent with the NDcPP because the individual security functions needed to satisfy the objective do not contradict with the security functions required by the NDcPP.
          </consistency-rationale>
          <addressed-by>FAU_GEN.1/MACSEC</addressed-by>
          <rationale>
            This SFR helps satisfy the TOE objective by defining auditable events for security-relevant functions that are specific to this PP-Module.
          </rationale>
        </SO>
        
        
        <SO name="O.TSF_INTEGRITY">
          <description>
            To mitigate the security risk that the MACsec device may fail during startup, 
            it is required to fail-secure if any self-test failures occur during startup. 
            This ensures that the device will only operate when it is in a known state.
            <h:p/>
            <h:b>Addressed by:</h:b> FPT_FLS.1
          </description>
          <consistency-rationale>
            The NDcPP does not define any TOE objectives; instead, it maps SFRs directly to threats. 
            This TOE objective is consistent with the NDcPP because the individual security functions needed to satisfy the objective do not contradict with the security functions required by the NDcPP.
          </consistency-rationale>
          <addressed-by>FPT_FLS.1</addressed-by>
          <rationale>
            This SFR helps satisfy the TOE objective by defining a fail-secure method that preserves the integrity of the TSF by ensuring that it does not operate when it’s in an insecure or unknown state.
          </rationale>
        </SO>
        
        
      </SOs>
      </sec:Security_Objectives_for_the_TOE>
      
    <sec:Security_Objectives_for_the_Operational_Environment>
      All objectives for the operational environment of the Base-PP also apply to this PP-Module. 
      OE.NO_THRU_TRAFFIC_PROTECTION is still operative, but only for the interfaces in the TOE that are defined by the Base-PP and not the PP-Module.
    </sec:Security_Objectives_for_the_Operational_Environment>
    <sec:Security_Objectives_Rationale>
      <!-- NOTE: This section should remain empty and is populated from the rationale tags in the previous sections.  -->
    </sec:Security_Objectives_Rationale>
  </sec:Security_Objectives>
  
  <sec:Security_Requirements>
    <base-pp id="ND">
      <product_class>Network Device</product_class>
      <short>NDcPP</short>
      <cPP/>
      <version>2.2e</version>
      <url><![CDATA[https://www.niap-ccevs.org/profile/Info.cfm?PPID=447&id=447]]></url>
      <cPP/>
      <!-- 6.1.1 Consistency of TOE Type -->
      <con-toe>When this PP-Module is used to extend the NDcPP, the TOE type for the overall TOE is still a network device. 
        The TOE boundary is simply extended to include MACsec functionality that is provided by the network device. </con-toe>
      
      <!-- 6.1.2 Consistency of Security Problem Description -->
      <con-sec-prob>
        The threats defined by this PP-Module (see section 3.1) supplement those defined in the NDcPP as follows:
      </con-sec-prob>
      <!-- 6.1.3 Consistency of Objectives -->
      <con-obj/>
      <con-op-en>This PP-Module does not define any environmental objectives, but does note that OE.NO_THRU_TRAFFIC_PROTECTION from the NDcPP 
        only applies to the Base-PP external interfaces. This is because the MACsec interface defined by this PP-Module does enforce through-traffic protection.</con-op-en>
      
      <!-- 6.1.2 Consistency Rationale table for ND -->
      <con-mod ref="T.DATA_INTEGRITY">The threat of data integrity compromise at the layer 2 level is a specific threat that can be countered by MACsec technology.</con-mod>
      <con-mod ref="T.NETWORK_ACCESS">
        The threat of a malicious entity accessing protected network resources without authorization is a specific example of the 
        T.UNTRUSTED_COMMUNICATION_CHANNELS threat defined in the Base-PP.
      </con-mod>
      <con-mod ref="T.UNTRUSTED_MACSEC_COMMUNICATION_CHANNELS">
        The threat of disclosure of data in protected communications channels is the same as the T.UNTRUSTED_COMMUNICATION_CHANNELS threat in the NDcPP. 
        This PP-Module expands on that by introducing additional logical interfaces (MACsec, SNMP) that this threat applies to.
      </con-mod>
      
      
      <!-- 6.1.3 Consistency of Objectives -->      
      <con-mod ref="O.AUTHENTICATION_MACSEC">The Base-PP does not define any TOE objectives so PP-Module objectives do not conflict with it.</con-mod>
      <con-mod ref="O.AUTHORIZED_ADMINISTRATION">The Base-PP does not define any TOE objectives so PP-Module objectives do not conflict with it.</con-mod>
      <con-mod ref="O.CRYPTOGRAPHIC_FUNCTIONS_MACSEC">The Base-PP does not define any TOE objectives so PP-Module objectives do not conflict with it.</con-mod>
      <con-mod ref="O.PORT_FILTERING_MACSEC">The Base-PP does not define any TOE objectives so PP-Module objectives do not conflict with it.</con-mod>
      <con-mod ref="O.REPLAY_DETECTION">The Base-PP does not define any TOE objectives so PP-Module objectives do not conflict with it.</con-mod>
      <con-mod ref="O.SYSTEM_MONITORING_MACSEC">The Base-PP does not define any TOE objectives so PP-Module objectives do not conflict with it.</con-mod>
      <con-mod ref="O.TSF_INTEGRITY">The Base-PP does not define any TOE objectives so PP-Module objectives do not conflict with it.</con-mod>
      
      <!-- 6.1.4 Consistency of Requirements -->
      <!-- Covered by rationales in individual f-components -->
    </base-pp>
      <sfrs>
	<sec:man_fau title="Security Audit (FAU)">
        <f-component cc-id="fau_gen.1" name="Audit Data Generation (MACsec)" iteration="MACSEC">
          <consistency-rationale>
            This SFR is an iteration of a Base-PP requirement that defines additional auditable events for MACsec functionality that the Base-PP could not be expected to cover.
          </consistency-rationale>
<f-element>
            <title> The TSF shall be able to generate an audit record of the following auditable
              events: <h:ol type="a">
                <h:li>Start-up and shutdown of the audit functions;</h:li>
                <h:li>All auditable events for the [<h:i>not specified</h:i>] level of audit;</h:li>
                <h:li><h:b>All administrative actions;</h:b></h:li>
                <h:li><h:b>[<h:i>Specifically defined auditable events listed in the Auditable Events table (<xref to="auditMACSEC"/>)</h:i>]</h:b></h:li>
              </h:ol>
            <h:table>
              <h:tr>
                <h:th>Requirement</h:th>
                <h:th>Auditable Events</h:th>
                <h:th>Additional Audit Record Contents</h:th>
              </h:tr>
              <h:tr>
                <h:td>FCS_MACSEC_EXT.1</h:td>
                <h:td>Session establishment</h:td>
                <h:td>Secure Channel Identifier (SCI)</h:td>
              </h:tr>
              <h:tr>
                <h:td>FCS_MACSEC_EXT.3</h:td>
                <h:td>Creation and update of SAK</h:td>
                <h:td>Creation and update times</h:td>
              </h:tr>
              <h:tr>
                <h:td>FCS_MACSEC_EXT.4</h:td>
                <h:td>Creation of CA</h:td>
                <h:td>Connectivity Association Key Names (CKNs)</h:td>
              </h:tr>
              <h:tr>
                <h:td>FPT_RPL.1</h:td>
                <h:td>Detected replay attempt</h:td>
                <h:td>None</h:td>
              </h:tr>
            </h:table>
              <ctr ctr-type="Table" id="auditMACSEC">Auditable Events</ctr>
            </title>
</f-element>
  <f-element>
    <title>
      The TSF shall record within each audit record at least the following information: <h:ol type="a">
        <h:li>Date and time of the event, type of event, subject identity (if applicable), and the outcome (success or failure) of the event; and</h:li>
        <h:li>For each audit event type, based on the auditable event definitions of the functional components included in the 
          PP<h:b>-Module</h:b>/ST, [<h:i>information specified in column three of the Auditable Events table (<xref to="auditMACSEC"/>)</h:i>].</h:li>
      </h:ol>
    </title>
  <aactivity>
    <no-tests>
    The evaluator shall complete the evaluation activity for FAU_GEN.1 as described in the NDcPP for the auditable events defined in the PP-Module 
    in addition to the applicable auditable events that are defined in the NDcPP. 
    The evaluator shall also ensure that the administrative actions defined for this PP-Module are appropriately audited.
    </no-tests>
  </aactivity>
</f-element> 
        </f-component>

      </sec:man_fau>
     
     
      <sec:man_fcs title="Cryptographic Support (FCS)">
        
        <f-component cc-id="fcs_cop.1" name="Cryptographic Operation (AES-CMAC Keyed Hash Algorithm)" iteration="CMAC"> 
          <consistency-rationale>
            This PP-Module iterates an SFR defined in the Base-PP to define new cryptographic operations that are specific to the protocols defined in the PP-Module.
          </consistency-rationale>
          
          <f-element>
            <title>
              The TSF shall perform [<h:i>keyed-hash message authentication</h:i>] in accordance with a specified cryptographic algorithm [<h:i>AES-CMAC</h:i>]
              and cryptographic key sizes <h:b> 
                <selectables>
                  <selectable>128</selectable>
                  <selectable>256</selectable></selectables> bits and message digest size of 128 bits</h:b> that meets the following: [<h:i>NIST SP 800-38B</h:i>].
            </title>
            <note role="Application">
              AES-CMAC is a keyed hash function that is used as part of the key derivation function (KDF) that is used for key generation.
            </note>
          <aactivity>
            <TSS>
              <h:p>
              The evaluator shall examine the TSS to ensure that it specifies the following values used by the AES-CMAC function: key length, hash function used, block size, and output MAC length.
              </h:p>
            </TSS>
            <Guidance>
              <h:p>
              There are no guidance evaluation activities (EAs) for this component.
              </h:p>
            </Guidance>
              <Tests>
                The evaluator shall perform the following tests:
                <testlist>
                <test><h:b>CMAC Generation Test</h:b><h:br/>
                  To test the generation capability of AES-CMAC, the evaluator shall provide to the TSF, for each key length-message length-CMAC length tuple (in bytes), 
                  a set of eight arbitrary key-plaintext tuples that will result in the generation of a known MAC value when encrypted. 
                  The evaluator shall then verify that the correct MAC was generated in each case. 
                </test>
                  <test><h:b>CMAC Verification Test</h:b><h:br/>
                    <h:p>
                    To test the verification capability of AES-CMAC, the evaluator shall provide to the TSF, for each key length-message length-CMAC length tuple (in bytes), 
                    a set of 20 arbitrary key-MAC tuples that will result in the generation of known messages when verified. 
                    The evaluator shall then verify that the correct message was generated in each case.
                    </h:p><h:p>
                    The following information should be used by the evaluator to determine the key length-message length-CMAC length tuples that should be tested:
                    </h:p>
                    <h:ul>
                      <h:li>Key length: Values will include the following:
                      <h:ul>
                        <h:li>16</h:li>
                        <h:li>32</h:li>
                      </h:ul>
                      </h:li>
                      <h:li>Message length: Values will include the following:
                      <h:ul>
                        <h:li>0 (optional)</h:li>
                        <h:li>Largest value supported by the implementation (no greater than 65536)</h:li>
                        <h:li>Two values divisible by 16</h:li>
                        <h:li>Two values not divisible by 16</h:li>
                      </h:ul>
                      </h:li>
                      <h:li>CMAC length:
                      <h:ul>
                        <h:li>Smallest value supported by the implementation (no less than 1)</h:li>
                        <h:li>16</h:li>
                        <h:li>Any supported CMAC length between the minimum and maximum values</h:li>
                      </h:ul>
                      </h:li>
                    </h:ul>
                </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <f-component cc-id="fcs_cop.1" name="Cryptographic Operation (MACsec AES Data Encryption and Decryption)" iteration="MACSEC"> 
          <consistency-rationale>
            This PP-Module iterates an SFR defined in the Base-PP to define new cryptographic operations that are specific to the protocols defined in the PP-Module.
          </consistency-rationale>
          
          <f-element>
            <title>
              The TSF shall perform [<h:i>encryption and decryption</h:i>] in accordance with a specified cryptographic algorithm [<h:i>AES used in AES Key Wrap, GCM</h:i>]
              and cryptographic key sizes <h:b> 
                <selectables>
                  <selectable>128</selectable>
                  <selectable>256</selectable></selectables> bits</h:b> that meets the following: 
              [<h:i>AES as specified in ISO 18033-3, AES Key Wrap as specified in NIST SP 800-38F, GCM as specified in ISO 19772</h:i>].
            </title>
            <aactivity>
              <TSS>
                <h:p>
                  The evaluator shall verify that the TSS describes the supported AES modes that are required for this PP-Module in addition to the ones already required 
                  by the NDcPP in FCS_COP.1/DataEncryption.
                </h:p>
              </TSS>
              <Guidance>
                <h:p>
                  There are no guidance EAs for this component.
                </h:p>
              </Guidance>
              <Tests>
                The evaluator shall perform testing for AES-GCM as required by the NDcPP in FCS_COP.1/DataEncryption. 
                <h:p>
                In addition to the tests specified in the NDcPP for other iterations of FCS_COP.1, the evaluator shall perform the following tests:
                </h:p>
                  <testlist>
                    <test>
                      <h:b>KW-AE Test</h:b>: To test the authenticated encryption capability of AES key wrap (KW), the evaluator shall provide 
                      five sets of 100 messages and keys to the TOE for each key length supported by the TSF.
                      Each set of messages and keys shall correspond to one of five plaintext message lengths (detailed below). 
                      The evaluator shall have the TSF encrypt the messages with the associated key. 
                      The evaluator shall verify that the correct ciphertext was generated in each case.
                    </test>
                    <test>
                      <h:b>KW-AD Test</h:b>: To test the authenticated decryption capability of AES KW, the evaluator shall provide 
                      five sets of 100 messages and keys to the TOE for each key length supported by the TSF.
                      Each set of ciphertexts and keys shall correspond to one of five plaintext message lengths (detailed below). 
                      For each set of 100 ciphertext values, 20 shall not be authentic (i.e., fail authentication). 
                      The evaluator shall have the TSF decrypt the ciphertext messages with the associated key. 
                      The evaluator shall then verify the correct plaintext was generated or the failure to authenticate was correctly detected.
                      <h:p>
                      The messages in each set for both tests shall be the following lengths: <h:ul>
                        <h:li>two that are non-zero multiples of 128 bits (two semiblock lengths)</h:li>
                        <h:li>two that are odd multiples of the semiblock length (64 bits)</h:li>
                        <h:li>the largest supported plaintext length less than or equal to 4096 bits</h:li>
                      </h:ul>
                      </h:p>
                    </test>
                  </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
     
     
        <ext-comp-def title="MACsec" fam-id="FCS_MACSEC_EXT">
          <fam-behavior>This family defines requirements for implementation of MACsec functionality.</fam-behavior> 
        </ext-comp-def>
        <f-component cc-id="fcs_macsec_ext.1" name="MACsec"> 
          <consistency-rationale>
            This SFR applies to MACsec functionality, which is beyond the original scope of the Base-PP.
          </consistency-rationale>
          
          <comp-lev> requires the TSF to implement MACsec in a specified manner.
          </comp-lev>
          <management>No specific management functions are identified.
          </management>
          <audit>The following actions should be auditable if FAU_GEN Security audit data generation is included in the PP/ST: <h:ul>
            <h:li>Session establishment.</h:li>
          </h:ul>
          </audit>
          <dependencies>No dependencies.
          </dependencies>
          
          <f-element>
            <title>
              The TSF shall implement MACsec in accordance with IEEE Standard 802.1AE-2018. 
            </title>
          </f-element>
          <f-element>
            <title>
              The TSF shall derive a Secure Channel Identifier (SCI) from a peer’s MAC address and port to uniquely identify the originator of an MPDU.
            </title>
          </f-element>
          <f-element>
            <title>
              The TSF shall reject any MPDUs during a given session that contain an SCI other than the one used to establish that session.
            </title>
          </f-element>
          <f-element>
            <title>
              The TSF shall permit only EAPOL (Port Access Entity (PAE) EtherType 88-8E), MACsec frames (EtherType 88-E5), and MAC control frames (EtherType is 88-08) and shall discard others.
            </title>
            <note role="Application">
              Depending on the Carrier Ethernet service provider a TOE might need basic VLAN tag handling abilities such as a simple add or discard to be suitable for Use Case 2.
            </note>
            <aactivity>
              <TSS>
                <h:p>
                  The evaluator shall examine the TSS to verify that it describes the ability of the TSF to implement MACsec in accordance with IEEE 802.1AE-2018. 
                  The evaluator shall also determine that the TSS describes the ability of the TSF to derive SCI values from peer MAC address and port data 
                  and to reject traffic that does not have a valid SCI. 
                  Finally, the evaluator shall check the TSS for an assertion that only EAPOL, 
                  MACsec Ethernet frames, and MAC control frames are accepted by the MACsec interface.
                </h:p>
              </TSS>
              <Guidance>
                <h:p>
                  There are no guidance EAs for this component.
                </h:p>
              </Guidance>
              <Tests>
                
                The evaluator shall perform the following tests:
                <testlist>
                  <test>
                    The evaluator shall successfully establish a MACsec channel between the TOE and a MACsec-capable peer in the operational 
                    environment and verify that the TSF logs the communications. 
                    The evaluator shall capture the traffic between the TOE and the operational environment to determine the SCI 
                    that the TOE uses to identify the peer. The evaluator shall then configure a test system to capture traffic between the peer 
                    and the TOE to modify the SCI that is used to identify the peer. 
                    The evaluator then verifies that the TOE does not reply to this traffic and logs that the traffic was discarded.
                  </test>
                  <test>
                    The evaluator shall send Ethernet traffic to the TOE’s MAC address that iterates through the full range of supported EtherType values 
                    (refer to <h:a href="https://standards.ieee.org/develop/regauth/ethertype/eth.txt">List of Documented EtherTypes</h:a>) and observes that traffic for all EtherType values 
                    is discarded by the TOE except for the traffic which has an EtherType value of 88-8E, 88-E5, or 8808. 
                    Note that there are a large number of EtherType values so the evaluator is encouraged to execute a script that automatically iterates through each value.
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <f-component cc-id="fcs_macsec_ext.2" name="MACsec Integrity and Confidentiality"> 
          <consistency-rationale>
            This SFR applies to MACsec functionality, which is beyond the original scope of the Base-PP.
          </consistency-rationale>
          
          <comp-lev> requires the TSF to implement MACsec with support for integrity and confidentiality protection.
          </comp-lev>
          <management>No specific management functions are identified.
          </management>
          <audit>There are no auditable events foreseen.
          </audit>
          <dependencies>FCS_MACSEC_EXT.1 MACsec
          </dependencies>
          
          <f-element>
            <title>
              The TOE shall implement MACsec with support for integrity protection with a confidentiality offset of 
              <selectables>
                <selectable>0</selectable>
                <selectable>30</selectable>
                <selectable>50</selectable></selectables>.
            </title>
            <ext-comp-def-title>
              <title>The TOE shall implement MACsec with support for integrity protection with a confidentiality offset of 
                <assignable>supported confidentiality offset value(s)</assignable>.
              </title>
            </ext-comp-def-title>
          </f-element>
          <f-element>
            <title>
              The TSF shall provide assurance of the integrity of protocol data units (MPDUs) using an Integrity Check Value (ICV) derived with the SAK.
            </title>
          <note role="Application">
            The length of the ICV is dependent on the ciphersuite used but will not be less than 8 octets or more than 16 octets at the end of the MPDU. 
            The ICV protects the destination and source MAC address parameters, as well as all the fields of the MPDU.
          </note>
          </f-element>
          <f-element>
            <title>
              The TSF shall provide the ability to derive an Integrity Check Value Key (ICK) from a Connectivity Association Key (CAK) using a KDF.
            </title>

            <aactivity>
              <TSS>
                <h:p>
                The evaluator shall examine the TSS to verify that it describes the methods that the TOE implements to provide assurance of MACsec integrity.  
                This should include any confidentiality offsets used, the use of an ICV (including the supported length), 
                and ICV generation with the SAK, using the SCI as the most significant bits of the initialization vector (IV) and the 32 least significant bits of the PN as the IV.
                </h:p>
                </TSS>
              <Guidance>
                <h:p>
                If any integrity verifications are configurable, such as any confidentiality offsets used or the mechanism used to derive an ICK, 
                the evaluator shall verify that instructions for performing these functions are documented.
                </h:p>
              </Guidance>
              <Tests>
                The evaluator shall perform the following tests:
                <testlist>
                <test>
                  The evaluator shall transmit MACsec traffic to the TOE from a MACsec-capable peer in the operational environment. 
                  The evaluator shall verify via packet captures, audit logs, or both that the frame bytes after the MACsec Tag values in the received traffic 
                  is not obviously predictable.
                </test>
                <test>
                  The evaluator shall transmit valid MACsec traffic to the TOE from a MACsec-capable peer in the operational environment that is routed 
                  through a test system set up as a man-in-the-middle. 
                  The evaluator shall use the test system to intercept this traffic to modify one bit in a packet payload before retransmitting to the TOE. 
                  The evaluator shall verify that the traffic is discarded due to an integrity failure.
                </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <f-component cc-id="fcs_macsec_ext.3" name="MACsec Randomness"> 
          <consistency-rationale>
            This SFR applies to MACsec functionality, which is beyond the original scope of the Base-PP.
          </consistency-rationale>
          
          <comp-lev> requires the TSF to generate keys and key data using sufficient randomness.
          </comp-lev>
          <management>No specific management functions are identified.
          </management>
          <audit>The following actions should be auditable if FAU_GEN Security audit data generation is included in the PP/ST: <h:ul>
            <h:li>Creation and update of Secure Association Key.</h:li>
          </h:ul>
          </audit>
          <dependencies>FCS_MACSEC_EXT.1 MACsec<h:br/>
            FCS_RBG_EXT.1 Random Bit Generation
          </dependencies>
          
          <f-element>
            <title>
              The TSF shall generate unique Secure Association Keys (SAKs) using 
              <selectables>
                <selectable>key derivation from Connectivity Association Key (CAK) per section 9.8.1 of IEEE 802.1X-2010</selectable> 
                <selectable>the TOE’s random bit generator as specified by FCS_RBG_EXT.1</selectable>
              </selectables>
              such that the likelihood of a repeating SAK is no less than 1 in 2 to the power of the size of the generated key. 
            </title>
            <ext-comp-def-title>
              <title>The TSF shall generate unique Secure Association Keys (SAKs) using 
                <assignable>key generation or derivation method</assignable>
                such that the likelihood of a repeating SAK is no less than 1 in 2 to the power of the size of the generated key. 
              </title>
            </ext-comp-def-title>
          </f-element>
          <f-element>
            <title>
              The TSF shall generate unique nonces for the derivation of SAKs using the TOE’s random bit generator as specified by FCS_RBG_EXT.1.
            </title>
            <note role="Application">
              FCS_RBG_EXT.1 is defined in the Base-PP so a conformant MACsec TOE will include this dependency.
            </note>            
            <aactivity>
              <TSS>
              <h:p>
                The evaluator shall examine the TSS to verify that it describes 
                the method used to generate SAKs and nonces and that the strength of the CAK and the size of the CAK’s key space are provided.
              </h:p>  
              </TSS>
              <Guidance>
                <h:p>
                  There are no guidance EAs for this component.
                </h:p>
              </Guidance>
              <Tests>
                Testing of the TOE’s MACsec capabilities and verification of the deterministic random bit generator is sufficient to demonstrate that this SFR has been satisfied.
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        
        <f-component cc-id="fcs_macsec_ext.4" name="MACsec Key Usage"> 
          <consistency-rationale>
            This SFR applies to MACsec functionality, which is beyond the original scope of the Base-PP.
          </consistency-rationale>
          
          <comp-lev> requires the TSF to specify the supported methods of MACsec peer authentication and to define the lifecycle for keys used in support of this.
          </comp-lev>
          <management>The following actions could be considered for the management functions in FMT:
            <h:ul>
              <h:li>Specify the lifetime of a CAK.</h:li>
            </h:ul>
          </management>
          <audit>The following actions should be auditable if FAU_GEN Security audit data generation is included in the PP/ST: <h:ul>
            <h:li>Creation of CA.</h:li>
          </h:ul>
          </audit>
          <dependencies>FCS_COP.1 Cryptographic Operation<h:br/>
            FCS_MACSEC_EXT.1 MACsec<h:br/>
            FIA_PSK_EXT.1 Pre-Shared Key Composition
          </dependencies>
          
          <f-element>
            <title>
              The TSF shall support peer authentication using pre-shared keys (PSKs)
              <selectables>
                <selectable id="eap-tls-peer-auth">EAP-TLS with DevIDs</selectable>
                <selectable>no other method</selectable></selectables>.
            </title>
            <note role="Application">
              The definition of the peer’s CAK as defined by IEEE 802.1X-2010 is synonymous with the peer authentication performed here. 
              If "EAP-TLS with DevIDs" is selected, the FCS_DEVID_EXT.1 and FCS_EAPTLS_EXT.1 SFRs must be claimed. 
            </note>
          </f-element>
          <f-element>
            <title>
              The TSF shall distribute SAKs between MACsec peers using AES key wrap as specified in FCS_COP.1<h:b>/MACSEC</h:b>.
            </title>
            <ext-comp-def-title>
              <title>The TSF shall distribute SAKs between MACsec peers using AES key wrap as specified in FCS_COP.1.</title>
            </ext-comp-def-title>
            <note role="Application">
              This requirement applies to the SAKs that are generated by the TOE. They must be wrapped by the AES Key Wrap method specified in NIST SP 800-38F.
            </note>    
          </f-element>
          <f-element>
            <title>The TSF shall support specifying a lifetime for CAKs.</title>
          </f-element>
          <f-element>
            <title>The TSF shall associate Connectivity Association Key Names (CKNs) with SAKs that are defined 
              by the KDF using the CAK as input data (per IEEE 802.1X-2010, Section 9.8.1).</title>
          </f-element>
          <f-element>
            <title>
              The TSF shall associate CKNs with CAKs. 
              The length of the CKN shall be an integer number of octets, between 1 and 32 (inclusive).
            </title>
          <aactivity>
              <TSS>
                <h:p>
                  The evaluator shall check the TSS to ensure that it describes how the SAK is wrapped prior to being distributed using the 
                  AES implementation specified in this PP-Module.
                </h:p>
              </TSS>
              <Guidance>
                <h:p>
                  If the method of peer authentication is configurable, the evaluator shall verify that the guidance provides instructions on how to configure this. 
                  The evaluator shall also verify that the method of specifying a lifetime for CAKs is described.
                </h:p>
              </Guidance>
              <Tests>
                The evaluator shall perform the following tests:
                <testlist>
                  <test>
                    For each supported method of peer authentication in FCS_MACSEC_EXT.4.1, the evaluator shall follow the operational guidance 
                    to configure the supported method (if applicable). 
                    The evaluator shall set up a packet sniffer between the TOE and a MACsec-capable peer in the operational environment. 
                    The evaluator shall then initiate a connection between the TOE and the peer such that authentication occurs and a secure connection is established. 
                    The evaluator shall wait one minute and then disconnect the TOE from the peer and stop the sniffer. 
                    The evaluator shall use the packet captures to verify that the SC was established via 
                    the selected mechanism and that the non-VLAN EtherType of the first data frame sent between the TOE and the peer is 88-E5.
                  </test>
                  <test>
                    The evaluator shall capture traffic between the TOE and a MACsec-capable peer in the operational environment. 
                    The evaluator shall then cause the TOE to distribute a SAK to that peer, 
                    capture the MKPDUs from that operation, and verify the key is wrapped in the captured MKPDUs.
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
     
     
        <ext-comp-def title="MACsec Key Agreement" fam-id="FCS_MKA_EXT">
          <fam-behavior>This family defines requirements for MKA.</fam-behavior> 
        </ext-comp-def>
        <f-component cc-id="fcs_mka_ext.1" name="MACsec Key Agreement"> 
          <consistency-rationale>
            This SFR applies to a MACsec peer authentication mechanism, which is beyond the original scope of the Base-PP, 
            though it is based on the TLS implementation specified in the Base-PP.
          </consistency-rationale>
          
          <comp-lev> defines the TSF’s implementation of the Key Agreement Protocol.
          </comp-lev>
          <management>The following actions could be considered for the management functions in FMT: <h:ul>
            <h:li>Ability to create, delete, and activate MKA participants.</h:li>
            <h:li>Ability to generate a group CAK.</h:li>
          </h:ul>
          </management>
          <audit>There are no auditable events foreseen.
          </audit>
          <dependencies>FCS_MACSEC_EXT.1 MACsec
          </dependencies>
          
          <f-element>
            <title>
              The TSF shall implement Key Agreement Protocol (MKA) in accordance with IEEE 802.1X-2010 and 802.1Xbx-2014.
            </title>
            <!-- <aactivity><elev/> -->
            <!--   <no-tests/> -->
            <!-- </aactivity> -->
          </f-element>
          <f-element>
            <title>
              The TSF shall provide assurance of the integrity of MKA protocol data units (MKPDUs) 
              using an Integrity Check Value (ICV) derived from an Integrity Check Value Key (ICK).
            </title>
            <note role="Application">
              The ICV has length 128 bits and is computed according to Section 9.4.1 of IEEE 802.1X-2010. 
              The ICV protects the destination and source MAC address parameters, 
              as well as all the fields of the MAC Service Data Unit of the MKPDU including the allocated EtherType, 
              and up to but not including, the generated ICV.
            </note>
            <!-- <aactivity><elev/> -->
            <!--   <no-tests/> -->
            <!-- </aactivity> -->
          </f-element>
          <f-element>
            <title>
              The TSF shall provide the ability to derive an Integrity Check Value Key (ICK) from a CAK using a KDF.
            </title>
            <aactivity><elev/>
              <TSS>
                <h:p>
                  The evaluator shall examine the TSS to verify that it describes the methods that the TOE implements to provide assurance of MKA integrity, 
                  including the use of an ICV and the ability to use a KDF to derive an ICK. 
                </h:p>
              </TSS>
              <Guidance>
                <h:p>
                  There are no guidance EAs for this element.
                </h:p>
              </Guidance>
              <Tests>
                <h:p>
                  The evaluator shall perform the following tests:
                  <testlist>
                    <test>
                      The evaluator shall transmit MKA traffic (MKPDUs) to the TOE from an MKA-capable peer in the operational environment. 
                      The evaluator shall verify via packet captures, audit logs, or both that the last 16 octets of the MKPDUs in the 
                      received traffic do not appear to be predictable.
                    </test>
                    <test>
                      The evaluator shall transmit valid MKA traffic to the TOE from an MKA-capable peer in the operational environment that is routed 
                      through a test system set up as a man-in-the-middle. 
                      The evaluator shall use the test system to intercept this traffic to modify one bit in a packet payload before retransmitting to the TOE. 
                      The evaluator shall verify that the traffic is discarded due to an integrity failure.
                    </test>
                  </testlist>
                </h:p>
              </Tests>
            </aactivity>
          </f-element>
          <f-element>
            <title>
              The TSF shall enforce an MKA Lifetime Timeout limit of 6.0 seconds and MKA Bounded Hello Timeout limit of 0.5 seconds.
            </title>
            <note role="Application">
              The key server may also distribute a group CAK established by pairwise CAKs.
            </note>
            <aactivity><elev/>
              <TSS>
                <h:p>
                  There are no TSS EAs for this element.
                </h:p>
              </TSS>
              <Guidance>
                <h:p>
                  There are no guidance EAs for this element.
                </h:p>
              </Guidance>
              <Tests>
                <h:p>
                  The tests below require the TOE to be deployed in an environment with two MACsec-capable peers, identified as devices B and C, 
                  that the TOE can communicate with. 
                  Prior to performing these tests, the evaluator shall follow the steps in the guidance documentation to configure the TOE as the 
                  key server and principal actor (peer). The evaluator shall then perform the following tests:
                  <testlist>
                    <test>
                      The evaluator shall send a fresh SAK that includes both peers as active participants. 
                      The evaluator shall start an MKA session between the TOE and the two active participant peers and send MKPDUs. 
                      The evaluator shall verify from packet captures that MKPDUs are sent at least once every half-second.
                    </test>
                    <test>
                      Disconnect one of the peers. Using a man-in-the-middle device, arbitrarily introduce an artificial delay in sending a fresh SAK following 
                      the change in the Live Peer List. 
                      Repeat Test 1 delaying a fresh SAK for MKA Lifetime traffic and observe that the timeout of 6.0 seconds is enforced by the TSF.
                    </test>
                  </testlist>
                </h:p>
              </Tests>
            </aactivity>
          </f-element>
          <f-element>
          <title>
            The key server shall refresh a SAK when it expires. The key server shall distribute a SAK by <selectables><bulletize/>
              <selectable>a group CAK, distributed by a group CAK</selectable>
              <selectable>a group CAK, distributed by pairwise CAKs derived from MKA</selectable>
              <selectable>a group CAK, distributed by pre-shared key (PSK)</selectable>
              <selectable>pairwise CAKs, derived from MKA</selectable>
              <selectable>pairwise CAKs that are PSKs</selectable></selectables>.
          </title>
            <ext-comp-def-title>
              <title>
                The key server shall refresh a SAK when it expires. The key server shall distribute a SAK by 
                <assignable>key type and distribution method</assignable>.
              </title>
            </ext-comp-def-title>
            <!-- <aactivity><elev/> -->
            <!--   <no-tests/> -->
            <!-- </aactivity> -->
          </f-element>
          <f-element>
            <title>
              The key server shall distribute a fresh SAK whenever a member is added to or removed from the live membership of the CA.
            </title>
            <!-- <aactivity><elev/> -->
            <!--   <no-tests/> -->
            <!-- </aactivity> -->
          </f-element>
          <f-element>
            <title>
              The TSF shall validate MKPDUs according to IEEE 802.1X-2010 Section 11.11.2. 
              In particular, the TSF shall discard without further processing any MKPDUs to which any of the following conditions apply: 
              <h:ol type="a">
                <h:li>The destination address of the MKPDU was an individual address</h:li>
                <h:li>The MKPDU is less than 32 octets long</h:li>
                <h:li>The MKPDU comprises fewer octets than indicated by the 
                  Basic Parameter Set body length, as encoded in bits 4 through 1 of octet 3 and bits 8 through 1 of octet 4, plus 16 octets of ICV</h:li>
                <h:li>The CAK Name is not recognized</h:li>
              </h:ol>
              If an MKPDU passes these tests, then the TSF will begin processing it as follows: <h:ol type="a">
                <h:li>If the Algorithm Agility parameter identifies an algorithm that has been implemented by the receiver, 
                  the ICV shall be verified as specified in IEEE 802.1X-2010 Section 9.4.1.</h:li>
                <h:li>If the Algorithm Agility parameter is unrecognized or not implemented by the receiver, 
                  its value can be recorded for diagnosis but the received MKPDU shall be discarded without further processing.</h:li>
              </h:ol>
              Each received MKPDU that is validated as specified in this clause and verified as specified in 
              IEEE 802.1X-2010 Section 9.4.1 shall be decoded as specified in IEEE 802.1X-2010 Section 11.11.4.
            </title>
            <aactivity><elev/>
              <TSS>
                <h:p>
                  The evaluator shall verify that the TSS describes the TOE’s compliance with IEEE 802.1X-2010 and 802.1Xbx-2014 for MKA, 
                  including the values for MKA and Hello timeout limits and support for data delay protection. 
                  The evaluator shall also verify that the TSS describes the ability of the PAE of the TOE to establish unique CAs with individual peers 
                  and group CAs using a group CAK such that a new group SAK is distributed every time the group’s membership changes. 
                  The evaluator shall also verify that the TSS describes the invalid MKPDUs that are discarded automatically by the TSF 
                  in a manner that is consistent with the SFR, and that valid MKPDUs are decoded in a manner consistent with IEEE 802.1X-2010 section 11.11.4.
                </h:p>
              </TSS>
              <Guidance>
                <h:p>
                  The evaluator shall verify that the guidance documentation provides instructions on how to configure the TOE to act as the key server 
                  in an environment with multiple MACsec-capable devices.
                </h:p>
              </Guidance>
              <Tests>
                <h:p>
                  The tests below require the TOE to be deployed in an environment with two MACsec-capable peers, identified as devices B and C, 
                  that the TOE can communicate with. 
                  Prior to performing these tests, the evaluator shall follow the steps in the guidance documentation to configure the TOE as the 
                  key server and principal actor (peer). The evaluator shall then perform the following tests:
                  <testlist>
                    <test>
                      The evaluator shall perform the following steps: <h:ol type="1">
                        <h:li>Load one PSK onto the TOE and device B and a second PSK onto the TOE and device C. This defines two pairwise CAs.</h:li>
                        <h:li>Generate a group CAK for the group of three devices using ieee8021XKayCreateNewGroup.</h:li>
                        <h:li>Observe via packet capture that the TOE distributes the group CAK to the two peers, protected by AES key wrap using their respective PSKs.</h:li>
                        <h:li>Verify that B can form an SA with C and connect securely.</h:li>
                        <h:li>Disable the KaY functionality of device C using ieee8021XPaePortKayMkaEnable.</h:li>
                        <h:li>Generate a group CAK for the TOE and B using ieee8021XKayCreateNewGroup and observe they can connect.</h:li>
                        <h:li>The evaluator shall have B attempt to connect to C and observe this fails.</h:li>
                        <h:li>Re-enable the KaY functionality of device C.</h:li>
                        <h:li>Invoke ieee8021XKayCreateNewGroup again.</h:li>
                        <h:li>Verify that both the TOE can connect to C and that B can connect to C.</h:li>
                      </h:ol>
                    </test>
                    <test>
                      The evaluator shall start an MKA session between the TOE and the two environmental MACsec peers and then perform the following steps:
                      <h:ol type="1">
                        <h:li>Send an MKPDU to the TOE's individual MAC address from a peer. Verify the frame is dropped and logged.</h:li>
                        <h:li>Send an MKPDU to the TOE that is less than 32 octets long. Verify the frame is dropped and logged.</h:li>
                        <h:li>Send an MKPDU to the TOE whose length in octets is not a multiple of four. Verify the frame is dropped and logged.</h:li>
                        <h:li>Send an MKPDU to the TOE that is one byte short. Verify the frame is dropped and logged.</h:li>
                        <h:li>Send an MKPDU to the TOE with unknown Agility Parameter. Verify the frame is dropped and logged.</h:li>
                      </h:ol>
                    </test>
                  </testlist>
                </h:p>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        <ext-comp-def title="Secure Device Identifiers" fam-id="FCS_DEVID_EXT">
          <fam-behavior>This family defines requirements for the implementation and use of Secure DevIDs.</fam-behavior> 
        </ext-comp-def>
        <f-component cc-id="fcs_devid_ext.1" name="Secure Device Identifiers">
          <depends on1="eap-tls-peer-auth"/>
          <consistency-rationale>
            This SFR applies to a MACsec peer authentication mechanism, which is beyond the original scope of the Base-PP.
          </consistency-rationale>
          
          <comp-lev> requires the TSF to implement and use DevIDs according to acceptable standards.
          </comp-lev>
          <management>No specific management functions are identified.
          </management>
          <audit>There are no auditable events foreseen.
          </audit>
          <dependencies>FCS_EAPTLS_EXT.1 EAP-TLS Protocol
          </dependencies>
          
          <f-element>
            <title>
              The TSF shall implement Secure Device Identifiers (DevIDs) following IEEE Standard 802.1AR-2018.
            </title>
            <!-- <aactivity><elev/> -->
            <!--   <no-tests/> -->
            <!-- </aactivity>  -->
          </f-element>
          <f-element>
            <title>
              The TSF shall contain an Initial DevID (IDevID) as specified in Section 6 of IEEE 802.1AR-2018.
            </title>
            <!-- <aactivity><elev/> -->
            <!--   <no-tests/> -->
            <!-- </aactivity>  -->
          </f-element>
          <f-element>
            <title>
              The TSF shall contain the credential chain as specified in Section 6.3 of IEEE 802.1AR-2018.
            </title>
            <!-- <aactivity><elev/> -->
            <!--   <no-tests/> -->
            <!-- </aactivity>  -->
          </f-element>
          <f-element>
            <title>
              The TSF shall verify that both the Supplicant and Authenticator DevIDs presented for EAP-TLS have credentials 
              that chain to one of the specified Certificate Authorities.
            </title>
            <!-- <aactivity><elev/> -->
            <!--   <no-tests/> -->
            <!-- </aactivity>  -->
          </f-element>
          <f-element>
            <title>
              The TSF shall not establish a trusted channel if the Supplicant DevID is invalid.
            </title>
            <aactivity><elev/>
              <TSS>
                <h:p>
                  The evaluator shall check the TSS to verify that it describes how the TSF implements and validates DevIDs.
                </h:p>
              </TSS>
              <Guidance>
                <h:p>
                  There are no guidance EAs for this element.
                </h:p>
              </Guidance>
              <Tests>
                <h:p>
                  The evaluator shall perform the following tests:
                </h:p>
                <testlist>
                  <test>
                    <h:ol type="1">
                      <h:li>The evaluator shall install a DevID in the Supplicant that has one octet changed to invalidate the signature.</h:li>
                      <h:li>The evaluator shall cause the Supplicant to initiate an EAP-TLS session with the Authenticator.</h:li>
                      <h:li>The evaluator shall verify that the connection fails.</h:li>
                    </h:ol>
                  </test>
                  <test>
                    <h:ol type="1">
                      <h:li>The evaluator shall install a DevID in the Supplicant with a valid signature but from an issuer not recognized by the Authenticator.</h:li>
                      <h:li>The evaluator shall cause the Supplicant to initiate an EAP-TLS session with the Authenticator.</h:li>
                      <h:li>The evaluator shall verify that the connection fails.</h:li>
                    </h:ol>
                  </test>
                  <test>
                    <h:ol type="1">
                      <h:li>The evaluator shall cause the Supplicant to initiate an EAP-TLS session with the Authenticator.</h:li>
                      <h:li>The evaluator shall intercept, manipulate, and retransmit the packets sent by the Supplicant 
                        so that the presented name differs from the name in the DevID.</h:li>
                      <h:li>The evaluator shall verify that the connection fails.</h:li>
                    </h:ol>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <f-element>
            <title>
              The TSF shall support mutual authentication using DevIDs.
            </title>
            <aactivity><elev/>
              <TSS>
                <h:p>
                  The evaluator shall check the TSS to verify that it describes the ability of the TSF to support mutual authentication using DevIDs.
                </h:p>
              </TSS>
              <Guidance>
                <h:p>
                  There are no guidance EAs for this element.
                </h:p>
              </Guidance>
              <Tests>
                <h:p>
                  The evaluator shall perform the following test:
                </h:p>
                <testlist>
                  <test>
                    <h:ul>
                      <h:li>Step 1: The evaluator shall cause the Supplicant to initiate an EAP-TLS session with the Authenticator in which mutual authentication is requested.</h:li>
                      <h:li>Step 2: The evaluator shall verify that the EAP-TLS packet with a Client Certificate Request message is sent and that the Supplicant responds with its DevID.</h:li>
                    </h:ul>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <f-element>
            <title>
              The TSF shall support the following operations as specified in Section 7.2 of IEEE 802.1AR-2018: <h:ol type="1">
                <h:li>Enable or disable DevID credential</h:li>
                <h:li>Enable or disable DevID key</h:li>
              </h:ol>
            </title>
          
            <aactivity><elev/>
              <TSS>
                <h:p>
                  The evaluator shall check the TSS to verify that it describes the ability of the TSF to support the signing, 
                  enable and disable DevID credential, and enable and disable DevID key operations.
                </h:p>
              </TSS>
              <Guidance>
                <h:p>
                  There are no guidance EAs for this element.
                </h:p>
              </Guidance>
              <Tests>
                <h:p>
                  The evaluator shall perform the following tests:
                </h:p>
                <testlist>
                  <test>
                    <h:ol type="1">
                      <h:li>The evaluator shall disable the Supplicant public key by setting MIB object devIDPublicKeyEnabled to false.</h:li>
                      <h:li>The evaluator shall cause Supplicant to initiate an EAP-TLS session with the Authenticator.</h:li>
                      <h:li>The evaluator shall verify that the Supplicant is unable to authenticate.</h:li>
                      <h:li>The evaluator shall re-enable the public key, then verify the Supplicant can authenticate.</h:li>
                    </h:ol>
                  </test>
                  <test>
                    <h:ol type="1">
                      <h:li>The evaluator shall disable the Supplicant DevID by setting MIB object devIDCredentialEnabled to false.</h:li>
                      <h:li>The evaluator shall cause Supplicant to initiate an EAP-TLS session with the Authenticator.</h:li>
                      <h:li>The evaluator shall verify that the Supplicant is unable to authenticate.</h:li>
                      <h:li>The evaluator shall re-enable the DevID, then verify the Supplicant can authenticate.</h:li>
                    </h:ol>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <ext-comp-def title="EAP-TLS Protocol" fam-id="FCS_EAPTLS_EXT">
          <fam-behavior>This family defines requirements for how the TSF implements EAP and EAP-Transport Layer Security.</fam-behavior> 
        </ext-comp-def>
        <f-component cc-id="fcs_eaptls_ext.1" name="EAP-TLS Protocol">
          <depends on1="eap-tls-peer-auth"/>
          <consistency-rationale>
            This SFR applies to a MACsec peer authentication mechanism, which is beyond the original scope of the Base-PP, 
            though it is based on the TLS implementation specified in the Base-PP.
          </consistency-rationale>
          
          <comp-lev> requires the TSF to implement EAP and EAP-TLS according to appropriate standards.
          </comp-lev>
          <management>No specific management functions are identified.
          </management>
          <audit>There are no auditable events foreseen.
          </audit>
          <dependencies>[(FCS_DTLSC_EXT.1 DTLS Client Protocol and <h:br/> 
            FCS_DTLSC_EXT.2 DTLS Client Support for Mutual Authentication), or <h:br/>
            FCS_DTLSS_EXT.1 DTLS Server Protocol and <h:br/> 
            FCS_DTLSS_EXT.2 DTLS Server Support for Mutual Authentication), or <h:br/>
            (FCS_TLSC_EXT.1 TLS Client Protocol and <h:br/> 
            FCS_TLSC_EXT.2 TLS Client Support for Mutual Authentication), or <h:br/>
            FCS_TLSS_EXT.1 TLS Server Protocol and <h:br/> 
            FCS_TLSS_EXT.2 TLS Server Support for Mutual Authentication)]
          </dependencies>
          
          <f-element>
            <title>
              The TSF shall implement the Extensible Authentication Protocol (EAP)
              as specified in RFC 3748 and EAP-Transport Layer Security (EAP-TLS) as specified in RFC 5216
              as updated by RFC 8996 with TLS implemented using mutual authentication in accordance with <selectables><bulletize/>
                <selectable>FCS_DTLSC_EXT.1 and FCS_DTLSC_EXT.2</selectable>
                <selectable>FCS_DTLSS_EXT.1 and FCS_DTLSS_EXT.2</selectable>
                <selectable>FCS_TLSC_EXT.1 and FCS_TLSC_EXT.2</selectable>
                <selectable>FCS_TLSS_EXT.1 and FCS_TLSS_EXT.2</selectable></selectables> <h:b>from the Base-PP</h:b>.
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall implement the Extensible Authentication Protocol (EAP)
                as specified in RFC 3748 and EAP-Transport Layer Security (EAP-TLS) as specified in RFC 5216
                as updated by RFC 8996 with TLS implemented using mutual authentication in accordance with <assignable>
                  TLS or DTLS implementation that supports mutual authentication</assignable>.
              </title>
            </ext-comp-def-title>
            <note role="Application">
              <h:p>
              If this SFR is selected, the FCS_(D)TLSC_EXT or FCS_(D)TLSS_EXT SFRs from the Base-PP must be included.
              </h:p><h:p>
              RFC 8996 deprecates TLS 1.1.
              </h:p>
            </note>
            <aactivity>
              <TSS>
                <h:p>
                  The evaluator shall check the TSS to verify that it describes the ability of the TSF to support EAP-TLS.
                </h:p>
              </TSS>
              <Guidance>
                <h:p>
                  There are no guidance EAs for this component.
                </h:p>
              </Guidance>
              <Tests>
                <h:p>
                  The evaluator shall set up an environment where the TOE can connect to a second MACsec device, identified as device B. 
                  The evaluator shall configure the devices to use EAP-TLS as the authentication method.  
                  The evaluator shall set up an authentication server, which may run on the TOE or be a separate device that connects to the test environment. 
                </h:p><h:p>
                  The evaluator shall then perform the following modifications to Request EAP packets from device B to the TOE: 
                  <h:ol type="1">
                    <h:li>The evaluator shall increment the length field of a Request EAP packet and verify that the TOE does not respond (i.e., silently discards the packet).</h:li>
                    <h:li>The evaluator shall append at least one octet to the end of a Request EAP packet and verify that the TOE responds as if there was no change 
                      (i.e., ignores the additional octets).</h:li>
                    <h:li>The evaluator shall modify the code field of a Request EAP packet to 5 and verify that the TOE does not respond (i.e., silently discards the packet).</h:li>
                  </h:ol>
                </h:p>
                <h:p>
                  Testing of the security of the (D)TLS protocol is performed as part of FCS_(D)TLSS_EXT.1 and .2 or FCS_(D)TLSC_EXT.1 and .2 in the Base-PP.
                </h:p>
              </Tests>
            </aactivity>  
          </f-element>
        </f-component>
        
        
        <ext-comp-def title="SNMP Protocol" fam-id="FCS_SNMP_EXT">
          <fam-behavior>This family defines requirements for implementation of SNMP.</fam-behavior> 
        </ext-comp-def>
        <f-component cc-id="fcs_snmp_ext.1" name="SNMP Protocol">
          <depends on1="snmp-trusted-path"/>
          <consistency-rationale>
            This SFR applies to implementation of the SNMP protocol, which is beyond the original scope of the Base-PP, 
            though it is based on the TLS implementation specified in the Base-PP.
          </consistency-rationale>
          
          <comp-lev> requires the TSF to implement and support SNMP using TLS using only algorithms that meet certain standards.
          </comp-lev>
          <management>No specific management functions are identified.
          </management>
          <audit>There are no auditable events foreseen.
          </audit>
          <dependencies>[(FCS_DTLSC_EXT.1 DTLS Client Protocol and <h:br/> 
            FCS_DTLSC_EXT.2 DTLS Client Support for Mutual Authentication), or <h:br/>
            FCS_DTLSS_EXT.1 DTLS Server Protocol and <h:br/> 
            FCS_DTLSS_EXT.2 DTLS Server Support for Mutual Authentication), or <h:br/>
            (FCS_TLSC_EXT.1 TLS Client Protocol and <h:br/> 
            FCS_TLSC_EXT.2 TLS Client Support for Mutual Authentication), or <h:br/>
            FCS_TLSS_EXT.1 TLS Server Protocol and <h:br/> 
            FCS_TLSS_EXT.2 TLS Server Support for Mutual Authentication)]
          </dependencies>
          
          <f-element>
            <title>
              The TSF shall support SNMP using TLS as specified in RFC 6353 as updated by RFC 8996 with TLS implemented using mutual authentication in accordance with 
              <selectables><bulletize/>
                <selectable>FCS_DTLSC_EXT.1 and FCS_DTLSC_EXT.2</selectable>
                <selectable>FCS_DTLSS_EXT.1 and FCS_DTLSS_EXT.2</selectable>
                <selectable>FCS_TLSC_EXT.1 and FCS_TLSC_EXT.2</selectable>
                <selectable>FCS_TLSS_EXT.1 and FCS_TLSS_EXT.2</selectable></selectables> <h:b>from the Base-PP</h:b>.
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall support SNMP using TLS as specified in RFC 6353 as updated by RFC 8996 with TLS implemented using mutual authentication in accordance with 
                <assignable>
                  TLS or DTLS implementation that supports mutual authentication</assignable>.
              </title>
            </ext-comp-def-title>
            <note role="Application">
              <h:p>
              If this SFR is selected, the appropriate FCS_(D)TLSC_EXT and FCS_(D)TLSS_EXT SFRs from the Base-PP must be included.
              </h:p>
              <!-- <comment> This app note (which was previously in the module) implies that 
                the TOE must implement both client and server capability (DTLSC + DTLSS, or TLSC + TLSS) but 
                the updated SFR makes client and server capabilities independently selectable. This app note was
                commented out per NIAP communication on 1/23/23 for future reconciliation with the SFR.
              <h:p>
              For SNMP to support both polling and notification (trap or inform) modes, 
              the managed device agent must support both (D)TLS server and client functions.
              </h:p> -->
            </note>
            <aactivity>
              <TSS>
                <h:p>
                  The evaluator shall check the TSS to verify that it describes the ability of the TSF to support SNMP-TLS.
                </h:p>
              </TSS>
              <Guidance>
                <h:p>
                  There are no guidance EAs for this component.
                </h:p>
              </Guidance>
              <Tests>
                <h:p>
                  The evaluator shall perform the following tests:  
                </h:p>
                <testlist>
                  <test>
                    The evaluator shall attempt to connect to the TOE using one of the SNMP-TLS ciphersuites supported by the TOE.  The evaluator shall confirm that the connection is successful.
                  </test>
                  <test>
                    The evaluator shall attempt to connect to the TOE using an SNMP-TLS ciphersuite not supported by the TOE.  The evaluator shall confirm that the connection is not successful.  
                  </test>
                </testlist>
                <h:p>
                  Testing of the security of the (D)TLS protocol is performed as part of testing FCS_(D)TLSS_EXT.1 and .2, or FCS_(D)TLSC_EXT.1 and .2 from the Base-PP.
                </h:p>
              </Tests>
            </aactivity>   
          </f-element>
        </f-component>
      </sec:man_fcs>

      <sec:man_fia title="Identification and Authentication (FIA)">
        
        <ext-comp-def title="Pre-Shared Key Composition" fam-id="FIA_PSK_EXT">
          <fam-behavior>This family defines requirements for the generation and use of PSKs. </fam-behavior> 
        </ext-comp-def>
        <f-component cc-id="fia_psk_ext.1" name="Pre-Shared Key Composition"> 
          <consistency-rationale>
            This SFR applies to PSKs for MKA, which is beyond the original scope of the Base-PP.
          </consistency-rationale>
          
          <comp-lev> defines the TSF’s uses for PSKs and how they are obtained by the TOE.
          </comp-lev>
          <management>The following actions could be considered for the management functions in FMT: <h:ul>
            <h:li>Generate and install a PSK-based CAK.</h:li>
            <h:li>Enable, disable, or delete a PSK-based CAK.</h:li>
          </h:ul>
          </management>
          <audit>There are no auditable events foreseen.
          </audit>
          <dependencies>No dependencies
          </dependencies>
          
          <f-element>
            <title>
              The TSF shall use PSKs for MKA as defined by IEEE 802.1X-2010, <selectables>
                <selectable>no other protocols</selectable>
                <selectable><assignable>other protocols that use PSKs</assignable></selectable></selectables>.
            </title>
            <note role="Application">If other protocols can use PSKs, they should be listed in the assignment as well; 
              otherwise “no other protocols” should be chosen.</note>
          </f-element>
          <f-element>
            <title>
              The TSF shall be able to 
              <selectables>
                <selectable>accept</selectable>
                <selectable>generate using the random bit generator specified in FCS_RBG_EXT.1</selectable></selectables> 
              bit-based PSKs.
            </title>
            <note role="Application">
              The ST author specifies whether the TSF merely accepts bit-based PSKs or if it is also capable of generating them. 
              If it generates them, the requirement specifies that they must be generated using the RBG provided by the TOE.
            </note>
          <aactivity>
            <TSS>
              <h:p>
                The evaluator shall examine the TSS to ensure it describes the process by which the bit-based PSKs are generated 
                (if the TOE supports this functionality), and confirm that this process uses the RBG specified in FCS_RBG_EXT.1.
              </h:p>
            </TSS>
            <Guidance>
              <h:p>
                The evaluator shall examine the operational guidance to determine that it provides guidance to administrators on the composition of strong PSKs, 
                and (if the selection indicates keys of various lengths can be entered) that it provides information on the range of lengths supported. 
              </h:p><h:p>
                The evaluator shall confirm the operational guidance contains instructions for either entering bit-based PSKs for each protocol 
                identified in the requirement, generating a bit-based PSK, or both. 
              </h:p>
            </Guidance>
            <Tests>
              <h:p>
                The evaluator shall also perform the following tests for each protocol (or instantiation of a protocol, 
                if performed by a different implementation on the TOE). Note that one or more of these tests can be performed with a single test case. 
                <testlist>
                  <test>
                    (conditional, the TOE supports PSKs of multiple lengths) The evaluator shall use the minimum length, 
                    the maximum length, a length inside the allowable range, and invalid lengths beyond the supported range (both higher and lower). 
                    The minimum, maximum, and included length tests should be successful, and the invalid lengths must be rejected by the TOE. 
                  </test>
                  <test>
                    (conditional, the TOE does not generate bit-based PSKs) The evaluator shall obtain a bit-based PSK of the appropriate length 
                    and enter it according to the instructions in the operational guidance. 
                    The evaluator shall then demonstrate that a successful protocol negotiation can be performed with the key. 
                  </test>
                  <test>
                    (conditional, the TOE can generate bit-based PSKs) The evaluator shall generate a bit-based PSK of the appropriate length 
                    and use it according to the instructions in the operational guidance. 
                    The evaluator shall then demonstrate that a successful protocol negotiation can be performed with the key.
                  </test>
                </testlist>
              </h:p>
            </Tests>
            </aactivity>
          </f-element>
        </f-component>
       <ext-comp-def title="Authentication Failure Handling" fam-id="FIA_AFL_EXT">
         <fam-behavior>This family defines requirements for handling of authentication failures beyond those defined in the Part 2 family FIA_AFL.</fam-behavior> 
       </ext-comp-def>
       <f-component cc-id="fia_afl_ext.1" name="Authentication Attempt Limiting">
	 <optional/>
         <consistency-rationale>
           This SFR defines a specific authentication limiting mechanism that exists on top of what FIA_AFL.1 in the Base-PP may also require.
         </consistency-rationale>
         
         <comp-lev> requires the TSF to limit the rate of login attempts to a certain interval after a certain number of failed authentication attempts have occurred.
         </comp-lev>
         <management>No specific management functions are identified.
         </management>
         <audit>There are no auditable events foreseen.
         </audit>
         <dependencies>FIA_UAU.1 Timing of Authentication
         </dependencies>
         
         <f-element>
           <title>
             When three unsuccessful authentication attempts have been made to the local console, the TSF shall limit the rate of login attempts to one per minute.
           </title>
           <note role="Application">
             This requirement applies to an administrator at a local console. This anti-hammering requirement is to slow down brute force password guessing.
           </note>
           <aactivity>
             <TSS>
               <h:p>
                 The evaluator shall examine the TSS to determine that it describes the ability of the TSF to limit the rate at which authentication attempts 
                 can be made at the local console following three successive failed attempts.
               </h:p>
             </TSS>
             <Guidance>
               <h:p>
                 If the TOE requires configuration to be put into a state where authentication attempt limiting is enforced, 
                 the evaluator shall review the operational guidance to verify that it describes the procedures to configure the TOE into this state.
               </h:p>
             </Guidance>
             <Tests>
               <h:p>
                 <testlist>
                   <test>
                     The evaluator shall follow the operational guidance to configure the TOE into a state that enforces authentication attempt limiting (if applicable). 
                     The evaluator shall successfully log in to the TOE at a local console, log back out, and immediately log back in 
                     in order to demonstrate that successive authentication attempts can be made in under a minute. 
                     The evaluator shall then enter an incorrect password three consecutive times for the same account to trigger authentication attempt limiting. 
                     Once the TOE is in this state, the evaluator shall attempt to log in to the TOE periodically over several attempts of 
                     varying time intervals and observe that authentication attempts cannot be made any more frequently than once per minute.
                   </test>
                 </testlist>
               </h:p>
             </Tests>
           </aactivity>  
         </f-element>
       </f-component>
       
      </sec:man_fia>
      
      <sec:man_fmt title="Security Management (FMT)">
        <f-component name="Specification of Management Functions (MACsec)" id="fel-managementfun-as" cc-id="fmt_smf.1" iteration="MACSEC">
			<consistency-rationale>
			  This SFR applies to management functions related to MACsec, which is beyond the original scope of the Base-PP.
			</consistency-rationale>
			<f-element>
			<title>The TSF shall be capable of performing the following management functions <h:b>related to MACsec functionality</h:b>: [<h:i>Ability of a Security Administrator to:
			  <h:ul>
			    <h:li>Manage a PSK-based CAK and install it in the device</h:li>
			    <h:li>Manage the key server to create, delete, and activate MKA participants <selectables>
			      <selectable>as specified in IEEE 802.1X-2020, Sections 9.13 and 9.16 (cf. MIB object ieee8021XKayMkaParticipant Entry)
			      and section 12.2 (cf. function createMKA()</selectable>
			      <selectable><assignable>other management function</assignable></selectable></selectables></h:li>
			    <h:li>Specify the lifetime of a CAK</h:li>
			    <h:li>Enable, disable, or delete a PSK-based CAK using <selectables>
			      <selectable>the MIB object ieee8021XKayMkaPartActivateControl</selectable>
			      <selectable><assignable>other management function</assignable></selectable></selectables></h:li>
			  </h:ul>
			  <selectables><bulletize/>
			    <selectable>Cause key server to generate a new group CAK (i.e., rekey the CA) using
			    <selectables>
			      <selectable>MIB object ieee8021XKayCreateNewGroup</selectable>
			      <selectable><assignable>other management function</assignable></selectable>
			    </selectables></selectable>
			    <selectable>Manage generation of a PSK-based CAK</selectable>
			    <selectable>No other MACsec management functions</selectable></selectables></h:i>].
			</title>
			  <note role="Application">
			    <h:p>
			    IEEE 802.1X-2010 specifies Management Information Base (MIB) objects for management functionality but configuration of management functions via other approved methods is acceptable. 
			    The ST author should select either the MIB object or provide the function used to achieve this management functionality.
			    </h:p><h:p>
			    If a selection containing “group CAK” is chosen in FCS_MKA_EXT.1.5, then “Cause key server to generate a new group CAK…” must be selected.
			    </h:p>
			  </note>
			<aactivity>
			  <TSS>
			    <h:p>
			      The evaluator shall verify that the TSS describes the ability of the TOE to provide the management functions defined in this SFR.
			    </h:p>
			  </TSS>
			  <Guidance>
			    <h:p>
			      The evaluator shall examine the operational guidance to determine that it provides instructions on how to perform each of the management functions defined in this SFR.
			    </h:p>
			  </Guidance>
			  <Tests>
			    <h:p>
			      The evaluator shall set up an environment where the TOE can connect to two other MACsec devices, identified as devices B and C, 
			      with the ability of PSKs to be distributed between them. 
			      The evaluator shall configure the devices so that the TOE will be elected key server and principal actor, i.e., has highest key server priority.
			    </h:p><h:p>
			      The evaluator shall follow the relevant operational guidance to perform the tests listed below. 
			      Note that if the TOE claims multiple management interfaces, the tests should be performed for each interface that supports the functions.
			    </h:p>
			    <testlist>
			      <test>
			        The evaluator shall connect to the PAE of the TOE and install a PSK. The evaluator shall then specify a CKN and that the PSK is to be used as a CAK.
			        <h:ul>
			        <h:li>Repeat this test for both 128-bit and 256-bit key sizes.</h:li>
			        <h:li>Repeat this test for a CKN of valid length (1-32 octets), and observe success.</h:li>
			        <h:li>Repeat this test again for CKN of invalid lengths zero and 33, and observe failure.</h:li>
			        </h:ul>
			      </test>
			      <test>
			        The evaluator shall test the ability of the TOE to enable and disable MKA participants using the management function specified in the ST. 
			        The evaluator shall install PSKs in devices B and C, and take any necessary additional steps to create corresponding MKA participants. 
			        The evaluator shall disable the MKA participant on device C, then observe that the TOE can communicate with B but neither the TOE nor B can communicate with device C. 
			        The evaluator shall re-enable the MKA participant of device B and observe that the TOE is now able to communicate with devices B and C.
			      </test>
			      <test>
			        For TOEs using only PSKs, the TOE should be the key server in both tests and only one peer (B) needs to be tested. The tests are:
			        <testlist>
			          <test>
			            Switch to unexpired CKN: TOE and Peer B have CKN1(10 minutes) and CKN2. 
			            CKN2 can either be configured with a longer overlapping lifetime (20 minutes) 
			            or be configured with a lifetime starting period of more than 10 minutes after the CKN1 start. 
			            The TOE and Peer B start using CKN1 and after 10 minutes, verify that the TOE expires SAK1. 
			            This can be verified by either 1) seeing the TOE immediately distribute a new SAK to the peer if the lifetime of CKN2 overlaps CKN1, 
			            or 2) by terminating the connection with CKN1 and distributing a new SAK once the lifetime period of CKN2 begins.
			          </test>
			          <test>
			            Reject CA with expired CKN: TOE has CKN1 (10 minutes). 
			            Peer B has CKN1 (20 minutes). 
			            TOE and Peer B start using CKN1 and after 10 minutes, 
			            verify that the TOE rejects (or ignores) peer’s request to use (or distribute) a SAK using CKN1.
			          </test>
			        </testlist>
			      </test>
			      <test>
			        (conditional, "Cause key server to generate a new group CAK..." is selected) The evaluator shall connect to the PAE of the TOE, 
			        set the management function specified in the ST (e.g., set ieee8021XKayCreateNewGroup to true), and observe that the TOE distributes a new group CAK.
			      </test>
			    </testlist>
			  </Tests>
			</aactivity>
		</f-element>
	      </f-component>

        
        <ext-comp-def title="SNMP Management" fam-id="FMT_SNMP_EXT">
          <fam-behavior>This family defines the TOE’s use of SNMP as a management interface.</fam-behavior> 
        </ext-comp-def>
        <f-component cc-id="fmt_snmp_ext.1" name="SNMP Management">
          <depends on1="snmp-trusted-path"/>
          <consistency-rationale>
            This SFR defines requirements for use of SNMP as a management interface, which is beyond the original scope of the Base-PP.
          </consistency-rationale>
          
          <comp-lev> requires the TSF to implement SNMP with (D)TLS in conformance with specific standards for use as a management interface.
          </comp-lev>
          <management>No specific management functions are identified.
          </management>
          <audit>There are no auditable events foreseen.
          </audit>
          <dependencies>FCS_SNMP_EXT.1 SNMP Protocol
            
          </dependencies>
          
          <f-element>
            <title>
              The TSF shall implement Simple Network Management Protocol (SNMP) with TLS security in conformance with 
              RFC 6353 “Transport Layer Security (TLS) Transport Model for the Simple Network Management Protocol (SNMP).”
            </title>
          </f-element>
          <f-element>
            <title>The TSF shall permit access to TSF management functions using only SNMP version 3.</title>
          </f-element>
          <f-element>
            <title>
              The TSF shall support the following password quality metrics for SNMPv3 passwords: [<h:i>character selections and minimum length defined in FIA_PMG_EXT.1</h:i>].
            </title>
          <ext-comp-def-title>
            <title>
              The TSF shall support the following password quality metrics for SNMPv3 passwords: <assignable>password quality metrics</assignable>.
            </title>
          </ext-comp-def-title>
            <note role="Application">
              FIA_PMG_EXT.1 is defined in the Base-PP so a conformant MACsec TOE will include this dependency.
            </note>
            <aactivity>
              <TSS>
                <h:p>
                  The evaluator shall examine the TSS to determine that it describes the ability of the TSF to support SNMPv3 
                  for remote management for connections to authorized IT entities (per FTP_TRP.1/MACSEC),
                  and that it can apply appropriate password restrictions to this interface.
                </h:p>
              </TSS>
              <Guidance>
                <h:p>
                  If the TOE requires configuration to be put into a state where SNMPv3 is the only version of SNMP that is accepted, 
                  the evaluator shall verify that the operational guidance provides instructions on how to disable unsupported versions of SNMP.
                </h:p>
              </Guidance>
              <Tests>
                <h:p>
                  The evaluator shall configure the TOE in accordance with its operational guidance to accept no versions of SNMP other than SNMPv3 (if applicable). 
                  The evaluator shall then perform the following tests:  
                </h:p>
                <testlist>
                  <test>
                    The evaluator shall attempt to connect to the TOE using SNMPv2 and observe that the connection is not successful.
                  </test>
                  <test>
                    The evaluator shall attempt to connect to the TOE using SNMPv1 and observe that the connection is not successful.  
                  </test>
                </testlist>
                <h:p>
                  Testing of the security of the SNMPv3 trusted path is done as part of FCS_SNMP_EXT.1. 
                  Testing of the password complexity policy is performed as part of FIA_PMG_EXT.1 in the Base-PP. 
                  Testing of the ability to manage the TSF using SNMPv3 is carried out as part of FMT_SMF.1/MACSEC.
                </h:p>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
      </sec:man_fmt>
      
      <sec:man_fpt title="Protection of the TSF (FPT)">
        
        <ext-comp-def title="Protection of CAK Data" fam-id="FPT_CAK_EXT">
          <fam-behavior>This family defines confidentiality requirements for CAK data.</fam-behavior> 
        </ext-comp-def>
        <f-component cc-id="fpt_cak_ext.1" name="Protection of CAK Data"> 
          <consistency-rationale>
            This SFR requires that keys specific to MACsec be protected. 
            This is similar to FPT_SKP_EXT.1 in the Base-PP but applies to keys that were beyond the original scope of the Base-PP.
          </consistency-rationale>
          
          <comp-lev> requires the TSF to prevent administrators from being able to read the CAK values.
          </comp-lev>
          <management>No specific management functions are identified.
          </management>
          <audit>There are no auditable events foreseen.
          </audit>
          <dependencies>No dependencies
          </dependencies>
          
          <f-element>
            <title>
              The TSF shall prevent reading of CAK values by administrators.
            </title>
            <note role="Application">
              The intent is for the TOE to protect CAK data from unauthorized disclosure. 
              This data should only be accessed for the purposes of its assigned security functionality and there is no need for it to be displayed or accessed 
              at any other time. This requirement does not prevent the device from providing indication that these exist, 
              are in use, or are still valid. It does, however, restrict the reading of the values outright.
            </note>
            <aactivity>
              <TSS>
                <h:p>
                  The evaluator shall examine the TSS to determine that it details how CAKs are stored and that they are unable to be viewed 
                  through an interface designed specifically for that purpose. 
                  If these values are not stored in plaintext, the TSS shall describe how they are protected or obscured.
                </h:p>
              </TSS>
              <Guidance>
                <h:p>
                  There are no guidance EAs for this component.
                </h:p>
              </Guidance>
              <Tests>
                <h:p>
                  There are no test EAs for this component.
                </h:p>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <f-component cc-id="fpt_fls.1" name="Failure with Preservation of Secure State"> 
          <consistency-rationale>
            This SFR requires the TSF to react in a specific manner upon failure of specific self-tests. 
            The Base-PP defines FPT_TST_EXT.1 for self-test functionality, but does not define specific self-tests. 
            This PP-Module implies that certain self-tests must be done at minimum, but this does not conflict with what is permitted by the Base-PP.
          </consistency-rationale>

          <f-element>
            <title>
              The TSF shall <h:b>fail-secure</h:b> when <h:b>any of</h:b> the following types of failures occur: 
              [<h:i>failure of the power-on self-tests, failure of integrity check of the TSF executable image, failure of noise source health tests</h:i>].
            </title>
            <note role="application">
              The intent of this requirement is to express the fail secure capabilities that the TOE possesses. 
              This means that the TOE must be able to attain a secure/safe state (shutdown) when any of the identified failures occur. 
              For a TOE with redundant failover capability (that continues to operate if power-on self-test (POST) passes on the redundant component), 
              in the event of a POST failure on a redundant component, the specific component that received the POST failure will be shut down.  
              For conformance with other PP-Modules it might be a requirement for the fail-secure state to be “shut down.”
            </note>
            <aactivity>
              <TSS>
                <h:p>
                  The evaluator shall examine the TSS to determine that it indicates that the TSF will shut down if a self-test failure is detected. 
                  For TOEs with redundant failover capability, the evaluator shall examine the TSS to determine that it indicates that the failed components 
                  will shut down if a self-test failure is detected.
                </h:p>
              </TSS>
              <Guidance>
                <h:p>
                  The evaluator shall examine the operational guidance to verify that it describes the behavior of the TOE following a self-test failure
                  and actions that an administrator should take if it occurs.
                </h:p>
              </Guidance>
              <Tests>
                <h:p>
                  The following test may require the vendor to provide access to a test platform that provides the evaluator with the ability to modify the TOE internals 
                  in a manner that is not provided to end customers:
                  <testlist>
                    <test>
                      The evaluator shall modify the TSF in a way that will cause a self-test failure to occur. 
                      The evaluator shall determine that the TSF shuts down and that the behavior of the TOE is consistent with the operational guidance. 
                      The evaluator shall repeat this test for each type of self-test that can be deliberately induced to fail. 
                      For TOEs with redundant failover capability, the evaluator shall determine that the failed components shut down 
                      and the behavior of the TOE is consistent with the operational guidance. 
                      For each component, the evaluator shall repeat each type of self-test that can be deliberately induced to fail.
                    </test>
                  </testlist>
                </h:p>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        
        <f-component cc-id="fpt_rpl.1" name="Replay Detection"> 
          <consistency-rationale>
            This SFR applies to replay detection functionality, which is beyond the original scope of the Base-PP.
          </consistency-rationale>
          
          <f-element>
            <title>
              The TSF shall detect replay for the following entities: [<h:i>MPDUs, MKA frames</h:i>].
            </title>
          </f-element>
          <f-element>
            <title>The TSF shall perform [<h:i>discarding of the replayed data, logging of the detected replay attempt</h:i>]
            when replay is detected.</title>
          <note role="application">
            As per IEEE 802.1AE-2018, replay is detected by examining the PN value that is embedded in the SecTag
            that is at the header of the MPDU. The PN is encoded in octets 5 through 8 of the SecTag to support replay protection.
            </note>
            <aactivity>
              <TSS>
                <h:p>
                  The evaluator shall examine the TSS to determine that it describes how replay is detected for MPDUs and how replayed MPDUs are handled by the TSF.
                </h:p>
              </TSS>
              <Guidance>
                <h:p>
                  There are no guidance EAs for this component.
                </h:p>
              </Guidance>
              <Tests>
                <h:p>
                  The evaluator shall perform the following tests:
                </h:p><h:p>
                  Before performing each test, the evaluator shall successfully establish a MACsec channel between the TOE and a MACsec-capable peer 
                  in the operational environment sending enough traffic to see it working and verify the PN values increase for each direction.
                </h:p>
                <testlist>
                  <test>
                    The evaluator shall set up a MACsec connection with an entity in the operational environment. 
                    The evaluator shall then capture traffic sent from this remote entity to the TOE. 
                    The evaluator shall retransmit copies of this traffic to the TOE in order to impersonate the remote entity where the PN values 
                    in the SecTag of these packets are less than the lowest acceptable PN for the SA. 
                    The evaluator shall observe that the TSF does not take action in response to receiving these packets 
                    and that the audit log indicates that the replayed traffic was discarded.
                    <h:p>
                    The evaluator shall establish a MACsec connection between the TOE and a test system. 
                    The evaluator shall then capture traffic sent from the test system to the TOE. 
                    The evaluator shall retransmit copies of this traffic to the TOE in order to impersonate the remote entity where the PN values in the SecTag 
                    of these packets are less than the lowest acceptable PN for the SA. 
                    The evaluator shall observe that the TSF does not take action in response to receiving these packets 
                    and that the audit log indicates that the replayed traffic was discarded.
                    </h:p>
                  </test>
                  <test>
                    The evaluator shall capture frames during an MKA session and record the lowest PN observed in a particular time range. 
                    The evaluator shall then send a frame with a lower PN, and then verify that this frame is dropped. 
                    The evaluator shall verify that the device logged this event.
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
       <ext-comp-def title="Data Delay Protection" fam-id="FPT_DDP_EXT">
         <fam-behavior>This family defines requirements for enforcement of data delay protection.</fam-behavior> 
       </ext-comp-def>
       <f-component cc-id="fpt_ddp_ext.1" name="Data Delay Protection">
	 <optional/>
         <consistency-rationale>
           Data delay protection uses packet counting information from MKA packets to drop differentially delayed MACsec packets at the receiver.
         </consistency-rationale>
         
         <comp-lev> requires the TSF to use MKA PN information to enforce a data delay protection check of two seconds on MACsec protected frames.
         </comp-lev>
         <management>No specific management functions are identified.
         </management>
         <audit>There are no auditable events foreseen.
         </audit>
         <dependencies>FCS_MACSEC_EXT.4 MACsec Key Usage<h:br/>
           FCS_MKA_EXT.1 MACsec Key Agreement
         </dependencies>
         
         <f-element>
           <title>
             The TSF shall enable data delay protection for MKA that ensures data frames protected by MACsec are not delayed by more than two seconds.
           </title>
           <aactivity>
             <TSS>
               <h:p>
                 There are no TSS EAs for this component.
               </h:p>
             </TSS>
             <Guidance>
               <h:p>
                 There are no guidance EAs for this component.
               </h:p>
             </Guidance>
             <Tests>
               <h:p>
                 The test below requires the TOE to be deployed in an environment with two MACsec-capable peers, identified as devices B and C, that the TOE can communicate with. 
                 Prior to performing this test, the evaluator shall follow the steps in the guidance documentation to configure the TOE as the key server and principal actor. 
                 The evaluator shall then perform the following test:
               </h:p>
               <testlist>
                 <test>
                   The evaluator shall use a peer device to send traffic to the TOE, arbitrarily inducing artificial delays in their transmission using a man-in-the-middle setup. 
                   The evaluator shall observe that traffic delayed longer than 2.0 seconds is rejected.
                 </test>
               </testlist>
             </Tests>
           </aactivity>  
         </f-element>
       </f-component>
       
       
       <ext-comp-def title="Replay Protection" fam-id="FPT_RPL_EXT">
         <fam-behavior>This family defines replay detection methods that are not defined in the Part 2 family FPT_RPL. </fam-behavior> 
       </ext-comp-def>
       <f-component cc-id="fpt_rpl_ext.1" name="Replay Protection for XPN">
	 <optional/>
         <consistency-rationale>
           This SFR applies to replay detection functionality, which is beyond the original scope of the Base-PP.
         </consistency-rationale>
         
         <comp-lev> requires the TSF to support XPN as a method for detection of replayed traffic.
         </comp-lev>
         <management>No specific management functions are identified.
         </management>
         <audit>There are no auditable events foreseen.
         </audit>
         <dependencies>FCS_COP.1 Cryptographic Operation
         </dependencies>
         
         <f-element>
           <title>
             The TSF shall support extended packet numbering (XPN) as per IEEE 802.1AE-2018.
           </title>
         </f-element>
         <f-element>
           <title>
             The TSF shall support <selectables>
               <selectable>GCM-AES-XPN-128</selectable>
               <selectable>GCM-AES-XPN-256</selectable></selectables> as per IEEE 802.1AE-2018.
           </title>
           <note role="Application">
             XPN support is expected for devices that are capable of 40 Gbps or higher throughput. 
             This SFR is optional because not all conformant TOEs are expected to provide this level of bandwidth. 
             For XPN the full 64-bit PN is recovered using the 32 least significant bits conveyed in the SecTag and 
             the 32 most significant bits are recovered on receipt of a frame.
           </note>
         
         <aactivity>
           <TSS>
             <h:p>
               The evaluator shall examine the TSS to determine that it includes XPN in the description of how replay 
               is detected for MPDUs and how replayed MPDUs are handled by the TSF.
             </h:p>
           </TSS>
           <Guidance>
             <h:p>
               If the use of XPN or the XPN ciphersuites used by the TOE are configurable, 
               the evaluator shall examine the guidance documentation to determine that it describes how this is configured.
             </h:p>
           </Guidance>
           <Tests>
             <h:p>
               The evaluator shall perform the following tests:
             </h:p>
             <testlist>
               <test>
                 The evaluator shall establish a MACsec connection between the TOE and a test system using the GCM-AES-XPN-128 ciphersuite if selected, 
                 otherwise use GCM-AES-XPN-256. The evaluator shall write or obtain a script to send a small frame with a known payload (such as five bytes of all zeroes) to the TOE.
                 The evaluator shall activate a packet capture tool on the connection between the TOE and the test system 
                 and then use the test system to send this frame to the TOE 4,294,967,267 (2^32 + 1) times. 
                 The evaluator shall use the packet capture tool to verify that for the first and last frames sent, the least significant 32 bits are the same. 
                 This means the most significant bits should have been incremented during this test. Since the IV is different the two encrypted frames should be different. 
                 <h:p>
                 Note that if traffic is sent to the TOE at a rate of 10 GB/s, this will take approximately five minutes as per IEEE 802.1AE-2018.
                 </h:p>
               </test>
               <test>
                 If both ciphersuites were selected, then the evaluator shall reconfigure the TOE using the second ciphersuite and rerun Test 1 to demonstrate support for both ciphersuites.
               </test>
             </testlist>
           </Tests>
           </aactivity>  
         </f-element>
       </f-component>


     </sec:man_fpt>
    
	  <sec:man_ftp title="Trusted Path/Channels (FTP)">
	    
	      <f-component cc-id="ftp_itc.1" name="Inter-TSF Trusted Channel (MACsec Communications)" iteration="MACSEC"> 
	        <consistency-rationale>
	          This PP-Module defines an additional trusted channel function for MACsec communications, which is beyond the original scope of the Base-PP.
	        </consistency-rationale>
	        <f-element>
	          <title>
	            The TSF shall provide a communication channel between itself and 
	            <h:b>a MACsec peer</h:b> 
	            that is logically distinct from other communication channels and provides assured identification of its end points and protection of the channel data
	            from modification or disclosure. 
	          </title>
	        </f-element>
	        <f-element>
	          <title>
	            The TSF shall permit <selectables>
	              <selectable>the TSF</selectable>
	              <selectable>another trusted IT product</selectable></selectables> to initiate communication via the trusted channel.
	          </title>
	        </f-element>
	        <f-element>
	          <title>
	            The TSF shall initiate communication via the trusted channel for [<h:i>communications with MACsec peers that require the use of MACsec</h:i>].
	          </title>
	          <aactivity>
		    This SFR is addressed through evaluation of FCS_MACSEC_EXT.1 through FCS_MACSEC_EXT.4.		    
	            <no-tests/>
	          </aactivity>
	        </f-element>
	      </f-component>
     <f-component cc-id="ftp_trp.1" name="Trusted Path (MACsec Administration)" iteration="MACSEC">
       <optional/>
       <consistency-rationale>
         This PP-Module defines an optional method of administration for MACsec functionality using trusted protocols that are not defined in the Base-PP. 
         As this functionality is optional, a conformant TOE may also use the Base-PP’s trusted path to administer these functions.
       </consistency-rationale>
       <f-element>
         <title>
           The TSF shall provide a communication path between itself and [<h:i>remote</h:i>] users <h:b>using <selectables>
             <selectable>MACsec</selectable>
             <selectable id="snmp-trusted-path">SNMPv3</selectable></selectables> 
           </h:b>that is logically distinct from other communication paths and provides assured identification of its end points 
           and protection of the communicated data from [<h:i>modification, disclosure</h:i>].
         </title>
       </f-element>
       <f-element>
         <title>
           The TSF shall permit [<h:i>remote users</h:i>] to initiate communication via the trusted path.
         </title>
       </f-element>
       <f-element>
         <title>
           The TSF shall require the use of the trusted path for [<h:i>remote administration of MACsec management functions as defined in FMT_SMF.1/MACSEC</h:i>].
         </title>
         <note role="Application">
           This SFR is optional because it is permissible for the management functions defined in this PP-Module to be implemented 
           solely through the trusted path defined in FTP_TRP.1/Admin in the Base-PP. 
           If SNMP is selected, the FCS_SNMP_EXT.1 and FMT_SNMP_EXT.1 SFRs must be claimed.
         </note>
         <aactivity>
           <no-tests>
             <h:p>
             If “MACsec” is selected in FTP_TRP.1.1/MACSEC, this SFR is addressed through evaluation of FCS_MACSEC_EXT.1 through FCS_MACSEC_EXT.4.
             </h:p><h:p>
             If “SNMPv3” is selected in FTP_TRP.1.1/MACSEC, this SFR is addressed through evaluation of FCS_SNMP_EXT.1 and FMT_SNMP_EXT.1.
             </h:p><h:p>
             For these EAs, the evaluator shall ensure that the testing is performed on the management interface (e.g., if “MACsec” is selected in FTP_TRP.1.1/MACSEC, the evaluator shall repeat the testing as needed for the management interface and not rely on the testing of an outbound connection to an arbitrary MACsec peer).
             </h:p>
           </no-tests>
         </aactivity>
       </f-element>
     </f-component>	    
      </sec:man_ftp>
    </sfrs>
  </sec:Security_Requirements>

  <!-- <appendix title="Optional Requirements"> -->
  <!--   <sec:Strictly_Optional_Requirements> -->
  <!--     <audit-table id="opt-audit" table="optional"/> -->
  <!--   </sec:Strictly_Optional_Requirements> -->
  <!--   <sec:Objective_Requirements> -->
  <!--     <audit-table id="obj-audit" table="objective"/> -->
  <!--   </sec:Objective_Requirements> -->
  <!--   <sec:Implementation-based_Requirements> -->
  <!--     <audit-table id="impl-audit" table="feat-based"/> -->
  <!--   </sec:Implementation-based_Requirements> -->
  <!-- </appendix> -->

  <!-- <appendix title="Selection-based Requirements"> -->
  <!--     <audit-table id="impl-audit" table="sel-based"/> -->
  <!-- </appendix> -->
  
  <appendix title="Implicitly Satisfied Requirements" id="satisfiedreqs">
    <h:b><ctr ctr-type="Table" pre="Table " id="imp-sat-reqs-table">Implicitly Satisfied Requirements</ctr></h:b>
    <h:table>	
      <h:tr class="header"><h:td>Requirement</h:td><h:td>Rationale for Satisfaction</h:td></h:tr>
      <h:tr>
        <h:td><h:b>FIA_UAU.1 – Timing of Authentication</h:b></h:td>
        <h:td>
          FIA_AFL_EXT.1 has a dependency on FIA_UAU.1 because the notion of authentication failure handling implies the existence of an authentication mechanism.
          This dependency is addressed by a conformant TOE through the Base-PP requirement FIA_UAU_EXT.2, which defines authentication mechanisms specific to network devices.
        </h:td>
      </h:tr>
    </h:table> 
  </appendix>
  
  <appendix title="Allocation of Requirements in Distributed TOEs" id="allocation">
    
    For a distributed TOE, the SFRs in this PP-Module need to be met by the
    TOE as a whole, but not all SFRs will necessarily be implemented by all components. The
    following categories are defined in order to specify when each SFR must be implemented by a
    component: <h:ul>
      <h:li><h:b>All Components ("All"):</h:b> All components that comprise the distributed TOE must
        independently satisfy the requirement.</h:li>
      <h:li><h:b>At least one Component ("One"):</h:b> This requirement must be fulfilled by at least one
        component within the distributed TOE.</h:li>
      <h:li><h:b>Feature Dependent ("Feature Dependent"):</h:b> These requirements will only be
        fulfilled where the feature is implemented by the distributed TOE component (note
        that the requirement to meet the PP-Module as a whole requires that at least one component
        implements these requirements if they are claimed by the TOE).</h:li></h:ul>
    The table below specifies how each of the SFRs in this PP-Module must be met, using the categories above.
    
    <h:table>
      <h:tr class="header">
        <h:td>Requirement</h:td>
        <h:td>Description</h:td>
        <h:td>Distributed TOE SFR Allocation</h:td>
      </h:tr>
      <h:tr>
        <h:td>FAU_GEN.1/MACSEC</h:td>
        <h:td>Audit Data Generation (MACsec)</h:td>
        <h:td>All</h:td>
      </h:tr>
      <h:tr>
        <h:td>FCS_COP.1/CMAC</h:td>
        <h:td>Cryptographic Operation (AES-CMAC Keyed Hash Algorithm)</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FCS_COP.1/MACSEC</h:td>
        <h:td>Cryptographic Operation (MACsec AES Data Encryption and Decryption)</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FCS_MACSEC_EXT.1</h:td>
        <h:td>MACsec</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FCS_MACSEC_EXT.2</h:td>
        <h:td>MACsec Integrity and Confidentiality</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FCS_MACSEC_EXT.3</h:td>
        <h:td>MACsec Randomness</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FCS_MACSEC_EXT.4</h:td>
        <h:td>MACsec Key Usage</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FCS_MKA_EXT.1</h:td>
        <h:td>MACsec Key Agreement</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FIA_PSK_EXT.1</h:td>
        <h:td>Pre-Shared Key Composition</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FMT_SMF.1/MACSEC</h:td>
        <h:td>Specification of Management Functions (MACsec)</h:td>
        <h:td>One</h:td>
      </h:tr>
      <h:tr>
        <h:td>FPT_CAK_EXT.1</h:td>
        <h:td>Protection of CAK Data</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FPT_FLS.1</h:td>
        <h:td>Failure with Preservation of Secure State</h:td>
        <h:td>All</h:td>
      </h:tr>
      <h:tr>
        <h:td>FPT_RPL.1</h:td>
        <h:td>Replay Detection</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FPT_ITC.1/MACSEC</h:td>
        <h:td>Inter-TSF Trusted Channel (MACsec Communications)</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FIA_AFL_EXT.1</h:td>
        <h:td>Authentication Attempt Limiting</h:td>
        <h:td>One</h:td>
      </h:tr>
      <h:tr>
        <h:td>FPT_DDP_EXT.1</h:td>
        <h:td>Data Delay Protection</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FPT_RPL_EXT.1</h:td>
        <h:td>Replay Detection for XPN</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FTP_TRP.1/MACSEC</h:td>
        <h:td>Trusted Path (MACsec Administration)</h:td>
        <h:td>One</h:td>
      </h:tr>
      <h:tr>
        <h:td>FCS_DEVID_EXT.1</h:td>
        <h:td>Secure Device Identifiers</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FCS_EAPTLS_EXT.1</h:td>
        <h:td>EAP-TLS Protocol</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FCS_SNMP_EXT.1</h:td>
        <h:td>SNMP Protocol</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FMT_SNMP_EXT.1</h:td>
        <h:td>SNMP Management</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
    </h:table>
    
  </appendix>
  
  <appendix title="Entropy Documentation and Assessment" id="EAR">
    The TOE does not require any additional supplementary information to describe its entropy source beyond the requirements outlined in the Base-PP. 
    As with other Base-PP requirements, the only additional requirement is that the entropy documentation also applies to the specific 
    MACsec Ethernet encryption capabilities of the TOE that require random data, in addition to any functionality required by the Base-PP.
  </appendix>
  
  <bibliography>
    <cc-entry/>
    
    
    <entry id="bibNDcPP">
      <tag>NDcPP</tag>
      <description>
        <h:a href="https://www.niap-ccevs.org/MMO/PP/CPP_ND_V2.2E.pdf">collaborative Protection Profile for Network Devices</h:a>, Version 2.2e, March 23, 2020
      </description>
    </entry>
    
    <entry id="bibNDSD">
      <tag>NDcPP SD</tag>
      <description>
        <h:a href="https://www.niap-ccevs.org/MMO/PP/CPP_ND_V2.2-SD.pdf">Supporting Document - Evaluation Activities for Network Device cPP</h:a>, Version 2.2, December 2019
      </description>
    </entry>
    
    <entry id="bibmodfw">
      <tag>MOD_FW</tag>
      <description>
        <h:a href="https://www.niap-ccevs.org/MMO/PP/MOD_CPP_FW_v1.4e.pdf">PP-Module for Stateful Traffic Filter Firewalls</h:a>, Version 1.4 + Errata 20200625, June 25, 2020
      </description>
    </entry>
    
    <entry id="bibmodvpngw">
      <tag>MOD_VPNGW</tag>
      <description>
        <h:a href="https://www.niap-ccevs.org/MMO/PP/MOD_VPNGW_v1.2.pdf">PP-Module for VPN Gateways</h:a>, Version 1.2, March 31, 2022
      </description>
    </entry>

  </bibliography>
</Module>
